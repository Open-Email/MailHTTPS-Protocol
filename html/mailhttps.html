<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title></title>
  <style>
  @font-face {
  font-family: octicons-link;
  src: url(data:font/woff;charset=utf-8;base64,d09GRgABAAAAAAZwABAAAAAACFQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABEU0lHAAAGaAAAAAgAAAAIAAAAAUdTVUIAAAZcAAAACgAAAAoAAQAAT1MvMgAAAyQAAABJAAAAYFYEU3RjbWFwAAADcAAAAEUAAACAAJThvmN2dCAAAATkAAAABAAAAAQAAAAAZnBnbQAAA7gAAACyAAABCUM+8IhnYXNwAAAGTAAAABAAAAAQABoAI2dseWYAAAFsAAABPAAAAZwcEq9taGVhZAAAAsgAAAA0AAAANgh4a91oaGVhAAADCAAAABoAAAAkCA8DRGhtdHgAAAL8AAAADAAAAAwGAACfbG9jYQAAAsAAAAAIAAAACABiATBtYXhwAAACqAAAABgAAAAgAA8ASm5hbWUAAAToAAABQgAAAlXu73sOcG9zdAAABiwAAAAeAAAAME3QpOBwcmVwAAAEbAAAAHYAAAB/aFGpk3jaTY6xa8JAGMW/O62BDi0tJLYQincXEypYIiGJjSgHniQ6umTsUEyLm5BV6NDBP8Tpts6F0v+k/0an2i+itHDw3v2+9+DBKTzsJNnWJNTgHEy4BgG3EMI9DCEDOGEXzDADU5hBKMIgNPZqoD3SilVaXZCER3/I7AtxEJLtzzuZfI+VVkprxTlXShWKb3TBecG11rwoNlmmn1P2WYcJczl32etSpKnziC7lQyWe1smVPy/Lt7Kc+0vWY/gAgIIEqAN9we0pwKXreiMasxvabDQMM4riO+qxM2ogwDGOZTXxwxDiycQIcoYFBLj5K3EIaSctAq2kTYiw+ymhce7vwM9jSqO8JyVd5RH9gyTt2+J/yUmYlIR0s04n6+7Vm1ozezUeLEaUjhaDSuXHwVRgvLJn1tQ7xiuVv/ocTRF42mNgZGBgYGbwZOBiAAFGJBIMAAizAFoAAABiAGIAznjaY2BkYGAA4in8zwXi+W2+MjCzMIDApSwvXzC97Z4Ig8N/BxYGZgcgl52BCSQKAA3jCV8CAABfAAAAAAQAAEB42mNgZGBg4f3vACQZQABIMjKgAmYAKEgBXgAAeNpjYGY6wTiBgZWBg2kmUxoDA4MPhGZMYzBi1AHygVLYQUCaawqDA4PChxhmh/8ODDEsvAwHgMKMIDnGL0x7gJQCAwMAJd4MFwAAAHjaY2BgYGaA4DAGRgYQkAHyGMF8NgYrIM3JIAGVYYDT+AEjAwuDFpBmA9KMDEwMCh9i/v8H8sH0/4dQc1iAmAkALaUKLgAAAHjaTY9LDsIgEIbtgqHUPpDi3gPoBVyRTmTddOmqTXThEXqrob2gQ1FjwpDvfwCBdmdXC5AVKFu3e5MfNFJ29KTQT48Ob9/lqYwOGZxeUelN2U2R6+cArgtCJpauW7UQBqnFkUsjAY/kOU1cP+DAgvxwn1chZDwUbd6CFimGXwzwF6tPbFIcjEl+vvmM/byA48e6tWrKArm4ZJlCbdsrxksL1AwWn/yBSJKpYbq8AXaaTb8AAHja28jAwOC00ZrBeQNDQOWO//sdBBgYGRiYWYAEELEwMTE4uzo5Zzo5b2BxdnFOcALxNjA6b2ByTswC8jYwg0VlNuoCTWAMqNzMzsoK1rEhNqByEyerg5PMJlYuVueETKcd/89uBpnpvIEVomeHLoMsAAe1Id4AAAAAAAB42oWQT07CQBTGv0JBhagk7HQzKxca2sJCE1hDt4QF+9JOS0nbaaYDCQfwCJ7Au3AHj+LO13FMmm6cl7785vven0kBjHCBhfpYuNa5Ph1c0e2Xu3jEvWG7UdPDLZ4N92nOm+EBXuAbHmIMSRMs+4aUEd4Nd3CHD8NdvOLTsA2GL8M9PODbcL+hD7C1xoaHeLJSEao0FEW14ckxC+TU8TxvsY6X0eLPmRhry2WVioLpkrbp84LLQPGI7c6sOiUzpWIWS5GzlSgUzzLBSikOPFTOXqly7rqx0Z1Q5BAIoZBSFihQYQOOBEdkCOgXTOHA07HAGjGWiIjaPZNW13/+lm6S9FT7rLHFJ6fQbkATOG1j2OFMucKJJsxIVfQORl+9Jyda6Sl1dUYhSCm1dyClfoeDve4qMYdLEbfqHf3O/AdDumsjAAB42mNgYoAAZQYjBmyAGYQZmdhL8zLdDEydARfoAqIAAAABAAMABwAKABMAB///AA8AAQAAAAAAAAAAAAAAAAABAAAAAA==) format('woff');
}

.markdown-body .octicon {
  display: inline-block;
  fill: currentColor;
  vertical-align: text-bottom;
}

.markdown-body .anchor {
  float: left;
  line-height: 1;
  margin-left: -20px;
  padding-right: 4px;
}

.markdown-body .anchor:focus {
  outline: none;
}

.markdown-body h1 .octicon-link,
.markdown-body h2 .octicon-link,
.markdown-body h3 .octicon-link,
.markdown-body h4 .octicon-link,
.markdown-body h5 .octicon-link,
.markdown-body h6 .octicon-link {
  color: #1b1f23;
  vertical-align: middle;
  visibility: hidden;
}

.markdown-body h1:hover .anchor,
.markdown-body h2:hover .anchor,
.markdown-body h3:hover .anchor,
.markdown-body h4:hover .anchor,
.markdown-body h5:hover .anchor,
.markdown-body h6:hover .anchor {
  text-decoration: none;
}

.markdown-body h1:hover .anchor .octicon-link,
.markdown-body h2:hover .anchor .octicon-link,
.markdown-body h3:hover .anchor .octicon-link,
.markdown-body h4:hover .anchor .octicon-link,
.markdown-body h5:hover .anchor .octicon-link,
.markdown-body h6:hover .anchor .octicon-link {
  visibility: visible;
}

.markdown-body {
  -ms-text-size-adjust: 100%;
  -webkit-text-size-adjust: 100%;
  color: #24292e;
  line-height: 1.5;
  font-family: -apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol;
  font-size: 16px;
  line-height: 1.5;
  word-wrap: break-word;
}

.markdown-body .pl-c {
  color: #6a737d;
}

.markdown-body .pl-c1,
.markdown-body .pl-s .pl-v {
  color: #005cc5;
}

.markdown-body .pl-e,
.markdown-body .pl-en {
  color: #6f42c1;
}

.markdown-body .pl-s .pl-s1,
.markdown-body .pl-smi {
  color: #24292e;
}

.markdown-body .pl-ent {
  color: #22863a;
}

.markdown-body .pl-k {
  color: #d73a49;
}

.markdown-body .pl-pds,
.markdown-body .pl-s,
.markdown-body .pl-s .pl-pse .pl-s1,
.markdown-body .pl-sr,
.markdown-body .pl-sr .pl-cce,
.markdown-body .pl-sr .pl-sra,
.markdown-body .pl-sr .pl-sre {
  color: #032f62;
}

.markdown-body .pl-smw,
.markdown-body .pl-v {
  color: #e36209;
}

.markdown-body .pl-bu {
  color: #b31d28;
}

.markdown-body .pl-ii {
  background-color: #b31d28;
  color: #fafbfc;
}

.markdown-body .pl-c2 {
  background-color: #d73a49;
  color: #fafbfc;
}

.markdown-body .pl-c2:before {
  content: "^M";
}

.markdown-body .pl-sr .pl-cce {
  color: #22863a;
  font-weight: 700;
}

.markdown-body .pl-ml {
  color: #735c0f;
}

.markdown-body .pl-mh,
.markdown-body .pl-mh .pl-en,
.markdown-body .pl-ms {
  color: #005cc5;
  font-weight: 700;
}

.markdown-body .pl-mi {
  color: #24292e;
  font-style: italic;
}

.markdown-body .pl-mb {
  color: #24292e;
  font-weight: 700;
}

.markdown-body .pl-md {
  background-color: #ffeef0;
  color: #b31d28;
}

.markdown-body .pl-mi1 {
  background-color: #f0fff4;
  color: #22863a;
}

.markdown-body .pl-mc {
  background-color: #ffebda;
  color: #e36209;
}

.markdown-body .pl-mi2 {
  background-color: #005cc5;
  color: #f6f8fa;
}

.markdown-body .pl-mdr {
  color: #6f42c1;
  font-weight: 700;
}

.markdown-body .pl-ba {
  color: #586069;
}

.markdown-body .pl-sg {
  color: #959da5;
}

.markdown-body .pl-corl {
  color: #032f62;
  text-decoration: underline;
}

.markdown-body details {
  display: block;
}

.markdown-body summary {
  display: list-item;
}

.markdown-body a {
  background-color: transparent;
}

.markdown-body a:active,
.markdown-body a:hover {
  outline-width: 0;
}

.markdown-body strong {
  font-weight: inherit;
  font-weight: bolder;
}

.markdown-body h1 {
  font-size: 2em;
  margin: .67em 0;
}

.markdown-body img {
  border-style: none;
}

.markdown-body code,
.markdown-body kbd,
.markdown-body pre {
  font-family: monospace,monospace;
  font-size: 1em;
}

.markdown-body hr {
  box-sizing: content-box;
  height: 0;
  overflow: visible;
}

.markdown-body input {
  font: inherit;
  margin: 0;
}

.markdown-body input {
  overflow: visible;
}

.markdown-body [type=checkbox] {
  box-sizing: border-box;
  padding: 0;
}

.markdown-body * {
  box-sizing: border-box;
}

.markdown-body input {
  font-family: inherit;
  font-size: inherit;
  line-height: inherit;
}

.markdown-body a {
  color: #0366d6;
  text-decoration: none;
}

.markdown-body a:hover {
  text-decoration: underline;
}

.markdown-body strong {
  font-weight: 600;
}

.markdown-body hr {
  background: transparent;
  border: 0;
  border-bottom: 1px solid #dfe2e5;
  height: 0;
  margin: 15px 0;
  overflow: hidden;
}

.markdown-body hr:before {
  content: "";
  display: table;
}

.markdown-body hr:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body table {
  border-collapse: collapse;
  border-spacing: 0;
}

.markdown-body td,
.markdown-body th {
  padding: 0;
}

.markdown-body details summary {
  cursor: pointer;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body h1 {
  font-size: 32px;
}

.markdown-body h1,
.markdown-body h2 {
  font-weight: 600;
}

.markdown-body h2 {
  font-size: 24px;
}

.markdown-body h3 {
  font-size: 20px;
}

.markdown-body h3,
.markdown-body h4 {
  font-weight: 600;
}

.markdown-body h4 {
  font-size: 16px;
}

.markdown-body h5 {
  font-size: 14px;
}

.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
}

.markdown-body h6 {
  font-size: 12px;
}

.markdown-body p {
  margin-bottom: 10px;
  margin-top: 0;
}

.markdown-body blockquote {
  margin: 0;
}

.markdown-body ol,
.markdown-body ul {
  margin-bottom: 0;
  margin-top: 0;
  padding-left: 0;
}

.markdown-body ol ol,
.markdown-body ul ol {
  list-style-type: lower-roman;
}

.markdown-body ol ol ol,
.markdown-body ol ul ol,
.markdown-body ul ol ol,
.markdown-body ul ul ol {
  list-style-type: lower-alpha;
}

.markdown-body dd {
  margin-left: 0;
}

.markdown-body code,
.markdown-body pre {
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
}

.markdown-body pre {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body input::-webkit-inner-spin-button,
.markdown-body input::-webkit-outer-spin-button {
  -webkit-appearance: none;
  appearance: none;
  margin: 0;
}

.markdown-body .border {
  border: 1px solid #e1e4e8!important;
}

.markdown-body .border-0 {
  border: 0!important;
}

.markdown-body .border-bottom {
  border-bottom: 1px solid #e1e4e8!important;
}

.markdown-body .rounded-1 {
  border-radius: 3px!important;
}

.markdown-body .bg-white {
  background-color: #fff!important;
}

.markdown-body .bg-gray-light {
  background-color: #fafbfc!important;
}

.markdown-body .text-gray-light {
  color: #6a737d!important;
}

.markdown-body .mb-0 {
  margin-bottom: 0!important;
}

.markdown-body .my-2 {
  margin-bottom: 8px!important;
  margin-top: 8px!important;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .py-0 {
  padding-bottom: 0!important;
  padding-top: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .py-2 {
  padding-bottom: 8px!important;
  padding-top: 8px!important;
}

.markdown-body .pl-3,
.markdown-body .px-3 {
  padding-left: 16px!important;
}

.markdown-body .px-3 {
  padding-right: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .f6 {
  font-size: 12px!important;
}

.markdown-body .lh-condensed {
  line-height: 1.25!important;
}

.markdown-body .text-bold {
  font-weight: 600!important;
}

.markdown-body:before {
  content: "";
  display: table;
}

.markdown-body:after {
  clear: both;
  content: "";
  display: table;
}

.markdown-body>:first-child {
  margin-top: 0!important;
}

.markdown-body>:last-child {
  margin-bottom: 0!important;
}

.markdown-body a:not([href]) {
  color: inherit;
  text-decoration: none;
}

.markdown-body blockquote,
.markdown-body dl,
.markdown-body ol,
.markdown-body p,
.markdown-body pre,
.markdown-body table,
.markdown-body ul {
  margin-bottom: 16px;
  margin-top: 0;
}

.markdown-body hr {
  background-color: #e1e4e8;
  border: 0;
  height: .25em;
  margin: 24px 0;
  padding: 0;
}

.markdown-body blockquote {
  border-left: .25em solid #dfe2e5;
  color: #6a737d;
  padding: 0 1em;
}

.markdown-body blockquote>:first-child {
  margin-top: 0;
}

.markdown-body blockquote>:last-child {
  margin-bottom: 0;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #c6cbd1;
  border-bottom-color: #959da5;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #959da5;
  color: #444d56;
  display: inline-block;
  font-size: 11px;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body h1,
.markdown-body h2,
.markdown-body h3,
.markdown-body h4,
.markdown-body h5,
.markdown-body h6 {
  font-weight: 600;
  line-height: 1.25;
  margin-bottom: 16px;
  margin-top: 24px;
}

.markdown-body h1 {
  font-size: 2em;
}

.markdown-body h1,
.markdown-body h2 {
  border-bottom: 1px solid #eaecef;
  padding-bottom: .3em;
}

.markdown-body h2 {
  font-size: 1.5em;
}

.markdown-body h3 {
  font-size: 1.25em;
}

.markdown-body h4 {
  font-size: 1em;
}

.markdown-body h5 {
  font-size: .875em;
}

.markdown-body h6 {
  color: #6a737d;
  font-size: .85em;
}

.markdown-body ol,
.markdown-body ul {
  padding-left: 2em;
}

.markdown-body ol ol,
.markdown-body ol ul,
.markdown-body ul ol,
.markdown-body ul ul {
  margin-bottom: 0;
  margin-top: 0;
}

.markdown-body li {
  word-wrap: break-all;
}

.markdown-body li>p {
  margin-top: 16px;
}

.markdown-body li+li {
  margin-top: .25em;
}

.markdown-body dl {
  padding: 0;
}

.markdown-body dl dt {
  font-size: 1em;
  font-style: italic;
  font-weight: 600;
  margin-top: 16px;
  padding: 0;
}

.markdown-body dl dd {
  margin-bottom: 16px;
  padding: 0 16px;
}

.markdown-body table {
  display: block;
  overflow: auto;
  width: 100%;
}

.markdown-body table th {
  font-weight: 600;
}

.markdown-body table td,
.markdown-body table th {
  border: 1px solid #dfe2e5;
  padding: 6px 13px;
}

.markdown-body table tr {
  background-color: #fff;
  border-top: 1px solid #c6cbd1;
}

.markdown-body table tr:nth-child(2n) {
  background-color: #f6f8fa;
}

.markdown-body img {
  background-color: #fff;
  box-sizing: content-box;
  max-width: 100%;
}

.markdown-body img[align=right] {
  padding-left: 20px;
}

.markdown-body img[align=left] {
  padding-right: 20px;
}

.markdown-body code {
  background-color: rgba(27,31,35,.05);
  border-radius: 3px;
  font-size: 85%;
  margin: 0;
  padding: .2em .4em;
}

.markdown-body pre {
  word-wrap: normal;
}

.markdown-body pre>code {
  background: transparent;
  border: 0;
  font-size: 100%;
  margin: 0;
  padding: 0;
  white-space: pre;
  word-break: normal;
}

.markdown-body .highlight {
  margin-bottom: 16px;
}

.markdown-body .highlight pre {
  margin-bottom: 0;
  word-break: normal;
}

.markdown-body .highlight pre,
.markdown-body pre {
  background-color: #f6f8fa;
  border-radius: 3px;
  font-size: 85%;
  line-height: 1.45;
  overflow: auto;
  padding: 16px;
}

.markdown-body pre code {
  background-color: transparent;
  border: 0;
  display: inline;
  line-height: inherit;
  margin: 0;
  max-width: auto;
  overflow: visible;
  padding: 0;
  word-wrap: normal;
}

.markdown-body .commit-tease-sha {
  color: #444d56;
  display: inline-block;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 90%;
}

.markdown-body .blob-wrapper {
  border-bottom-left-radius: 3px;
  border-bottom-right-radius: 3px;
  overflow-x: auto;
  overflow-y: hidden;
}

.markdown-body .blob-wrapper-embedded {
  max-height: 240px;
  overflow-y: auto;
}

.markdown-body .blob-num {
  -moz-user-select: none;
  -ms-user-select: none;
  -webkit-user-select: none;
  color: rgba(27,31,35,.3);
  cursor: pointer;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  line-height: 20px;
  min-width: 50px;
  padding-left: 10px;
  padding-right: 10px;
  text-align: right;
  user-select: none;
  vertical-align: top;
  white-space: nowrap;
  width: 1%;
}

.markdown-body .blob-num:hover {
  color: rgba(27,31,35,.6);
}

.markdown-body .blob-num:before {
  content: attr(data-line-number);
}

.markdown-body .blob-code {
  line-height: 20px;
  padding-left: 10px;
  padding-right: 10px;
  position: relative;
  vertical-align: top;
}

.markdown-body .blob-code-inner {
  color: #24292e;
  font-family: SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  font-size: 12px;
  overflow: visible;
  white-space: pre;
  word-wrap: normal;
}

.markdown-body .pl-token.active,
.markdown-body .pl-token:hover {
  background: #ffea7f;
  cursor: pointer;
}

.markdown-body kbd {
  background-color: #fafbfc;
  border: 1px solid #d1d5da;
  border-bottom-color: #c6cbd1;
  border-radius: 3px;
  box-shadow: inset 0 -1px 0 #c6cbd1;
  color: #444d56;
  display: inline-block;
  font: 11px SFMono-Regular,Consolas,Liberation Mono,Menlo,Courier,monospace;
  line-height: 10px;
  padding: 3px 5px;
  vertical-align: middle;
}

.markdown-body :checked+.radio-label {
  border-color: #0366d6;
  position: relative;
  z-index: 1;
}

.markdown-body .tab-size[data-tab-size="1"] {
  -moz-tab-size: 1;
  tab-size: 1;
}

.markdown-body .tab-size[data-tab-size="2"] {
  -moz-tab-size: 2;
  tab-size: 2;
}

.markdown-body .tab-size[data-tab-size="3"] {
  -moz-tab-size: 3;
  tab-size: 3;
}

.markdown-body .tab-size[data-tab-size="4"] {
  -moz-tab-size: 4;
  tab-size: 4;
}

.markdown-body .tab-size[data-tab-size="5"] {
  -moz-tab-size: 5;
  tab-size: 5;
}

.markdown-body .tab-size[data-tab-size="6"] {
  -moz-tab-size: 6;
  tab-size: 6;
}

.markdown-body .tab-size[data-tab-size="7"] {
  -moz-tab-size: 7;
  tab-size: 7;
}

.markdown-body .tab-size[data-tab-size="8"] {
  -moz-tab-size: 8;
  tab-size: 8;
}

.markdown-body .tab-size[data-tab-size="9"] {
  -moz-tab-size: 9;
  tab-size: 9;
}

.markdown-body .tab-size[data-tab-size="10"] {
  -moz-tab-size: 10;
  tab-size: 10;
}

.markdown-body .tab-size[data-tab-size="11"] {
  -moz-tab-size: 11;
  tab-size: 11;
}

.markdown-body .tab-size[data-tab-size="12"] {
  -moz-tab-size: 12;
  tab-size: 12;
}

.markdown-body .task-list-item {
  list-style-type: none;
}

.markdown-body .task-list-item+.task-list-item {
  margin-top: 3px;
}

.markdown-body .task-list-item input {
  margin: 0 .2em .25em -1.6em;
  vertical-align: middle;
}

.markdown-body hr {
  border-bottom-color: #eee;
}

.markdown-body .pl-0 {
  padding-left: 0!important;
}

.markdown-body .pl-1 {
  padding-left: 4px!important;
}

.markdown-body .pl-2 {
  padding-left: 8px!important;
}

.markdown-body .pl-3 {
  padding-left: 16px!important;
}

.markdown-body .pl-4 {
  padding-left: 24px!important;
}

.markdown-body .pl-5 {
  padding-left: 32px!important;
}

.markdown-body .pl-6 {
  padding-left: 40px!important;
}

.markdown-body .pl-7 {
  padding-left: 48px!important;
}

.markdown-body .pl-8 {
  padding-left: 64px!important;
}

.markdown-body .pl-9 {
  padding-left: 80px!important;
}

.markdown-body .pl-10 {
  padding-left: 96px!important;
}

.markdown-body .pl-11 {
  padding-left: 112px!important;
}

.markdown-body .pl-12 {
  padding-left: 128px!important;
}

/*# sourceURL=webpack://./node_modules/github-markdown-css/github-markdown.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL25vZGVfbW9kdWxlcy9naXRodWItbWFya2Rvd24tY3NzL2dpdGh1Yi1tYXJrZG93bi5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSwwQkFBMEI7RUFDMUIsMkRBQXF0RTtBQUN2dEU7O0FBRUE7RUFDRSxxQkFBcUI7RUFDckIsa0JBQWtCO0VBQ2xCLDJCQUEyQjtBQUM3Qjs7QUFFQTtFQUNFLFdBQVc7RUFDWCxjQUFjO0VBQ2Qsa0JBQWtCO0VBQ2xCLGtCQUFrQjtBQUNwQjs7QUFFQTtFQUNFLGFBQWE7QUFDZjs7QUFFQTs7Ozs7O0VBTUUsY0FBYztFQUNkLHNCQUFzQjtFQUN0QixrQkFBa0I7QUFDcEI7O0FBRUE7Ozs7OztFQU1FLHFCQUFxQjtBQUN2Qjs7QUFFQTs7Ozs7O0VBTUUsbUJBQW1CO0FBQ3JCOztBQUVBO0VBQ0UsMEJBQTBCO0VBQzFCLDhCQUE4QjtFQUM5QixjQUFjO0VBQ2QsZ0JBQWdCO0VBQ2hCLGtJQUFrSTtFQUNsSSxlQUFlO0VBQ2YsZ0JBQWdCO0VBQ2hCLHFCQUFxQjtBQUN2Qjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7O0VBRUUsY0FBYztBQUNoQjs7QUFFQTs7RUFFRSxjQUFjO0FBQ2hCOztBQUVBOztFQUVFLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSxjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTs7Ozs7OztFQU9FLGNBQWM7QUFDaEI7O0FBRUE7O0VBRUUsY0FBYztBQUNoQjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7RUFDRSx5QkFBeUI7RUFDekIsY0FBYztBQUNoQjs7QUFFQTtFQUNFLHlCQUF5QjtFQUN6QixjQUFjO0FBQ2hCOztBQUVBO0VBQ0UsYUFBYTtBQUNmOztBQUVBO0VBQ0UsY0FBYztFQUNkLGdCQUFnQjtBQUNsQjs7QUFFQTtFQUNFLGNBQWM7QUFDaEI7O0FBRUE7OztFQUdFLGNBQWM7RUFDZCxnQkFBZ0I7QUFDbEI7O0FBRUE7RUFD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 */
  </style>
  <style>
  /**
 * prism.js default theme for JavaScript, CSS and HTML
 * Based on dabblet (http://dabblet.com)
 * @author Lea Verou
 */

code[class*="language-"],
pre[class*="language-"] {
	color: black;
	background: none;
	text-shadow: 0 1px white;
	font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
	font-size: 1em;
	text-align: left;
	white-space: pre;
	word-spacing: normal;
	word-break: normal;
	word-wrap: normal;
	line-height: 1.5;

	-moz-tab-size: 4;
	-o-tab-size: 4;
	tab-size: 4;

	-webkit-hyphens: none;
	-moz-hyphens: none;
	-ms-hyphens: none;
	hyphens: none;
}

pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
	text-shadow: none;
	background: #b3d4fc;
}

pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
code[class*="language-"]::selection, code[class*="language-"] ::selection {
	text-shadow: none;
	background: #b3d4fc;
}

@media print {
	code[class*="language-"],
	pre[class*="language-"] {
		text-shadow: none;
	}
}

/* Code blocks */
pre[class*="language-"] {
	padding: 1em;
	margin: .5em 0;
	overflow: auto;
}

:not(pre) > code[class*="language-"],
pre[class*="language-"] {
	background: #f5f2f0;
}

/* Inline code */
:not(pre) > code[class*="language-"] {
	padding: .1em;
	border-radius: .3em;
	white-space: normal;
}

.token.comment,
.token.prolog,
.token.doctype,
.token.cdata {
	color: slategray;
}

.token.punctuation {
	color: #999;
}

.token.namespace {
	opacity: .7;
}

.token.property,
.token.tag,
.token.boolean,
.token.number,
.token.constant,
.token.symbol,
.token.deleted {
	color: #905;
}

.token.selector,
.token.attr-name,
.token.string,
.token.char,
.token.builtin,
.token.inserted {
	color: #690;
}

.token.operator,
.token.entity,
.token.url,
.language-css .token.string,
.style .token.string {
	color: #9a6e3a;
	/* This background color was intended by the author of this theme. */
	background: hsla(0, 0%, 100%, .5);
}

.token.atrule,
.token.attr-value,
.token.keyword {
	color: #07a;
}

.token.function,
.token.class-name {
	color: #DD4A68;
}

.token.regex,
.token.important,
.token.variable {
	color: #e90;
}

.token.important,
.token.bold {
	font-weight: bold;
}
.token.italic {
	font-style: italic;
}

.token.entity {
	cursor: help;
}

/*# sourceURL=webpack://./node_modules/prismjs/themes/prism.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL25vZGVfbW9kdWxlcy9wcmlzbWpzL3RoZW1lcy9wcmlzbS5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7RUFJRTs7QUFFRjs7Q0FFQyxZQUFZO0NBQ1osZ0JBQWdCO0NBQ2hCLHdCQUF3QjtDQUN4QixzRUFBc0U7Q0FDdEUsY0FBYztDQUNkLGdCQUFnQjtDQUNoQixnQkFBZ0I7Q0FDaEIsb0JBQW9CO0NBQ3BCLGtCQUFrQjtDQUNsQixpQkFBaUI7Q0FDakIsZ0JBQWdCOztDQUVoQixnQkFBZ0I7Q0FDaEIsY0FBYztDQUNkLFdBQVc7O0NBRVgscUJBQXFCO0NBQ3JCLGtCQUFrQjtDQUNsQixpQkFBaUI7Q0FDakIsYUFBYTtBQUNkOztBQUVBOztDQUVDLGlCQUFpQjtDQUNqQixtQkFBbUI7QUFDcEI7O0FBRUE7O0NBRUMsaUJBQWlCO0NBQ2pCLG1CQUFtQjtBQUNwQjs7QUFFQTtDQUNDOztFQUVDLGlCQUFpQjtDQUNsQjtBQUNEOztBQUVBLGdCQUFnQjtBQUNoQjtDQUNDLFlBQVk7Q0FDWixjQUFjO0NBQ2QsY0FBYztBQUNmOztBQUVBOztDQUVDLG1CQUFtQjtBQUNwQjs7QUFFQSxnQkFBZ0I7QUFDaEI7Q0FDQyxhQUFhO0NBQ2IsbUJBQW1CO0NBQ25CLG1CQUFtQjtBQUNwQjs7QUFFQTs7OztDQUlDLGdCQUFnQjtBQUNqQjs7QUFFQTtDQUNDLFdBQVc7QUFDWjs7QUFFQTtDQUNDLFdBQVc7QUFDWjs7QUFFQTs7Ozs7OztDQU9DLFdBQVc7QUFDWjs7QUFFQTs7Ozs7O0NBTUMsV0FBVztBQUNaOztBQUVBOzs7OztDQUtDLGNBQWM7Q0FDZCxvRUFBb0U7Q0FDcEUsaUNBQWlDO0FBQ2xDOztBQUVBOzs7Q0FHQyxXQUFXO0FBQ1o7O0FBRUE7O0NBRUMsY0FBYztBQUNmOztBQUVBOzs7Q0FHQyxXQUFXO0FBQ1o7O0FBRUE7O0NBRUMsaUJBQWlCO0FBQ2xCO0FBQ0E7Q0FDQyxrQkFBa0I7QUFDbkI7O0FBRUE7Q0FDQyxZQUFZO0FBQ2IiLCJzb3VyY2VSb290IjoiIn0= */
  </style>
  <style>
  
  </style>
  <style>
    .markdown-body {
      font-family: -apple-system,Segoe UI,Helvetica,Arial,sans-serif,Apple Color Emoji,Segoe UI Emoji;
      box-sizing: border-box;
      min-width: 200px;
      max-width: 980px;
      margin: 0 auto;
      padding: 45px;
    }

    @media not print {
      .markdown-body {
        padding: 45px;
      }

      @media (max-width: 767px) {
        .markdown-body {
          padding: 15px;
        }
      }
    }

    .hf-container {
      color: #24292e;
      line-height: 1.3;
    }

    .markdown-body .highlight pre,
    .markdown-body pre {
      white-space: pre-wrap;
    }
    .markdown-body table {
      display: table;
    }
    .markdown-body img[data-align="center"] {
      display: block;
      margin: 0 auto;
    }
    .markdown-body img[data-align="right"] {
      display: block;
      margin: 0 0 0 auto;
    }
    .markdown-body li.task-list-item {
      list-style-type: none;
    }
    .markdown-body li > [type=checkbox] {
      margin: 0 0 0 -1.3em;
    }
    .markdown-body input[type="checkbox"] ~ p {
      margin-top: 0;
      display: inline-block;
    }
    .markdown-body ol ol,
    .markdown-body ul ol {
      list-style-type: decimal;
    }
    .markdown-body ol ol ol,
    .markdown-body ol ul ol,
    .markdown-body ul ol ol,
    .markdown-body ul ul ol {
      list-style-type: decimal;
    }
  </style>
  <style>.markdown-body a.footnote-ref {
  text-decoration: none;
}

.footnotes {
  font-size: .85em;
  opacity: .8;
}

.footnotes li[role="doc-endnote"] {
  position: relative;
}

.footnotes .footnote-back {
  position: absolute;
  font-family: initial;
  top: .2em;
  right: 1em;
  text-decoration: none;
}

.inline-math.invalid,
.multiple-math.invalid {
  color: rgb(255, 105, 105);
}

.toc-container {
  width: 100%;
}

.toc-container .toc-title {
  font-weight: 700;
  font-size: 1.2em;
  margin-bottom: 0;
}

.toc-container li,
.toc-container ul,
.toc-container ul li {
  list-style: none !important;
}

.toc-container > ul {
  padding-left: 0;
}

.toc-container ul li span {
  display : flex;
}

.toc-container ul li span a {
  color: inherit;
  text-decoration: none;
}
.toc-container ul li span a:hover {
  color: inherit;
  text-decoration: none;
}

.toc-container ul li span span.dots {
  flex: 1;
  height: 0.65em;
  margin: 0 10px;
  border-bottom: 2px dotted black;
}

/*# sourceURL=webpack://./src/muya/lib/assets/styles/exportStyle.css */
/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9tdXlhL2xpYi9hc3NldHMvc3R5bGVzL2V4cG9ydFN0eWxlLmNzcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtFQUNFLHFCQUFxQjtBQUN2Qjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixXQUFXO0FBQ2I7O0FBRUE7RUFDRSxrQkFBa0I7QUFDcEI7O0FBRUE7RUFDRSxrQkFBa0I7RUFDbEIsb0JBQW9CO0VBQ3BCLFNBQVM7RUFDVCxVQUFVO0VBQ1YscUJBQXFCO0FBQ3ZCOztBQUVBOztFQUVFLHlCQUF5QjtBQUMzQjs7QUFFQTtFQUNFLFdBQVc7QUFDYjs7QUFFQTtFQUNFLGdCQUFnQjtFQUNoQixnQkFBZ0I7RUFDaEIsZ0JBQWdCO0FBQ2xCOztBQUVBOzs7RUFHRSwyQkFBMkI7QUFDN0I7O0FBRUE7RUFDRSxlQUFlO0FBQ2pCOztBQUVBO0VBQ0UsY0FBYztBQUNoQjs7QUFFQTtFQUNFLGNBQWM7RUFDZCxxQkFBcUI7QUFDdkI7QUFDQTtFQUNFLGNBQWM7RUFDZCxxQkFBcUI7QUFDdkI7O0FBRUE7RUFDRSxPQUFPO0VBQ1AsY0FBYztFQUNkLGNBQWM7RUFDZCwrQkFBK0I7QUFDakMiLCJzb3VyY2VSb290IjoiIn0= */</style>
  <style>.markdown-body{}pre.front-matter{display:none!important;}</style>
</head>
<body>
  <article class="markdown-body"><h1 class="atx" id="mailhttps---the-openemail-protocol">Mail/HTTPS - The OpenEmail Protocol</h1>
<div class="toc-container"><p class="toc-title">Table of Contents</p><ul class="toc-list"><li><span><a class="toc-h1" href="#mailhttps---the-openemail-protocol">Mail/HTTPS - The OpenEmail Protocol</a><span class="dots"></span></span></li><li><span><a class="toc-h1" href="#preface">Preface</a><span class="dots"></span></span></li><li><span><a class="toc-h1" href="#introduction">Introduction</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#complexity">Complexity</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#deliverability">Deliverability</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#address-secrecy">Address Secrecy</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#the-new-terminology">The New Terminology</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#authors-and-readers">Authors and Readers</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#mail-agents">Mail Agents</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#email-address">Email Address</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#public-profile">Public Profile</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#links">Links</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#broadcasts">Broadcasts</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#encryption">Encryption</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#signing">Signing</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#keys-rotation">Keys Rotation</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#authentication">Authentication</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#notifications">Notifications</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#message-lifetime">Message Lifetime</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#storage-separation">Storage Separation</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#multiplicity">Multiplicity</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#flow-overview">Flow Overview</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#email-address-1">Email Address</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#character-set">Character Set</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#local-part">Local Part</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#domain-part">Domain Part</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#display-name">Display Name</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#links-1">Links</a><span class="dots"></span></span></li><li><span><a class="toc-h1" href="#mail-agent">Mail Agent</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#discovery">Discovery</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#optimal-delegation">Optimal Delegation</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#public-profile-1">Public Profile</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#profile-location">Profile Location</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#required-fields">Required Fields</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#optional-fields">Optional Fields</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#unstructured-fields">Unstructured Fields</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#public-profile-image">Public Profile Image</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#profile-image-location">Profile Image Location</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#privacy-concerns">Privacy Concerns</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#encryption-and-signing">Encryption &amp; Signing</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#key-ids">Key IDs</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#fingerprints">Fingerprints</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#anonymous-asymmetric-encryption">Anonymous Asymmetric&nbsp;Encryption</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#large-message-handling">Large Message Handling</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#signing-1">Signing</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#message-object">Message Object</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#lifetime">Lifetime</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#access-rights">Access Rights</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#message-id">Message-Id</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#payload">Payload</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#encoding">Encoding</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#plaintext">Plaintext</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#files-attachments">Files (Attachments)</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#size">Size</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#headers">Headers</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#categorization">Categorization</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#message-envelope">Message Envelope</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#required-headers">Required Headers</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#conditional-headers">Conditional Headers</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#content-headers">Content Headers</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#mandatory-headers">Mandatory Headers</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#conditional-headers-1">Conditional Headers</a><span class="dots"></span></span></li></ul></li></ul></li><li><span><a class="toc-h1" href="#notifications-1">Notifications</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#payload-1">Payload</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#identifier">Identifier</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#lifetime-1">Lifetime</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#verification">Verification</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#execution">Execution</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#suppression">Suppression</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h1" href="#special-usecases">Special Usecases</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#key-rotations">Key Rotations</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#replies">Replies</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#forwarding">Forwarding</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#threading">Threading</a><span class="dots"></span></span></li><li><span><a class="toc-h2" href="#broadcasting">Broadcasting</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#direct-public-access">Direct Public Access</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#public-indexing">Public Indexing</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#re-broadcasting-messages">Re-broadcasting messages</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#public-replies">Public Replies</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h2" href="#address-expansions">Address Expansions</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#envelope">Envelope</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#content-headers-1">Content Headers</a><span class="dots"></span></span></li></ul></li></ul></li><li><span><a class="toc-h1" href="#https-api">HTTPS API</a><span class="dots"></span></span><ul><li><span><a class="toc-h2" href="#authentication-1">Authentication</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#sotn-scheme">SOTN Scheme</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#sotn-authorization-header-example">SOTN Authorization Header Example</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h2" href="#public-api">Public API</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#discovery-1">Discovery</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#domain">Domain</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#address">Address</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#provisioning">Provisioning</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#create">Create</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#delete">Delete</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#profile">Profile</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#profile-image">Profile Image</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#links-2">Links</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#query">Query</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#notifications-2">Notifications</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#abuse-prevention">Abuse Prevention</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#messages">Messages</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#private-messages">Private Messages</a><span class="dots"></span></span><ul><li><span><a class="toc-h5" href="#list">List</a><span class="dots"></span></span></li><li><span><a class="toc-h5" href="#retrieve">Retrieve</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h4" href="#broadcast-messages">Broadcast Messages</a><span class="dots"></span></span><ul><li><span><a class="toc-h5" href="#list-1">List</a><span class="dots"></span></span></li><li><span><a class="toc-h5" href="#retrieve-1">Retrieve</a><span class="dots"></span></span></li></ul></li></ul></li></ul></li><li><span><a class="toc-h2" href="#private-api">Private API</a><span class="dots"></span></span><ul><li><span><a class="toc-h3" href="#authenticated-discovery">Authenticated Discovery</a><span class="dots"></span></span></li><li><span><a class="toc-h3" href="#notifications-3">Notifications</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#list-2">List</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#messages-1">Messages</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#list-3">List</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#retrieve-2">Retrieve</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#status">Status</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#upload">Upload</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#delete-1">Delete</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#profile-1">Profile</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#update">Update</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#profile-image-1">Profile Image</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#update-1">Update</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#delete-2">Delete</a><span class="dots"></span></span></li></ul></li><li><span><a class="toc-h3" href="#links-3">Links</a><span class="dots"></span></span><ul><li><span><a class="toc-h4" href="#list-4">List</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#store">Store</a><span class="dots"></span></span></li><li><span><a class="toc-h4" href="#delete-3">Delete</a><span class="dots"></span></span></li></ul></li></ul></li></ul></li></ul></div><h1 class="atx" id="preface">Preface</h1>
<p>Legacy email was never intentionally designed; rather, it evolved organically, mimicking physical post-office workflows in a skeuomorphic fashion and inheriting the same underlying paradigms.</p>
<p>It is time to break clean from limitations and vulnerabilities of legacy email, starting from the underlying protocols and assumptions. Here at OpenEmail, we’ve designed a new public, open, decentralized protocol&nbsp;for the privacy and security needs of the modern world.</p>
<p>Named Mail/HTTPS, it is a pull-based message exchange built on top of HTTPS (HTTP over TLS). By thinking of email as sharing protocol rather than a sending one, HTTP emerges as an ideal medium - just as it was originally designed for sharing information online.</p>
<p>With Mail/HTTPS, running systems becomes no more complex than hosting simple websites, making self-hosting again possible. And since it’s both based on a public and open protocol with open source clients and servers, anyone can adopt, develop, and extend it.</p>
<p>It's about time we forget spam, filtering, provider "trust", IP&nbsp;reputations, blacklists, bounces, phishing, spoofing, 10-25MB&nbsp;limits and waiting for messages to "arrive."</p>
<p>Through Mail/HTTPS, OpenEmail brings truly digital native email, defining a new universal public secure channel, for all of us to use.</p>
<p>Having a protocol as an “overlay” on HTTPS tackles the key challenges that plague SMTP-based email - security, authenticity, spam, privacy, size constraints, and message lifecycles.</p>
<h1 class="atx" id="introduction">Introduction</h1>
<p>Mail/HTTPS (Mail over HTTPS - MoH) is a modern, asynchronous, stateless messaging system that leverages existing HTTPS infrastructure to replace traditional, more complex protocols. With its secure yet simple building blocks, Mail/HTTPS drives radical change in messaging, authentication, and open social networking, while simultaneously reducing reliance on centralized third-party entities.</p>
<p>Mail/HTTPS goes beyond just preventing spam and ensuring end-to-end privacy. It simplifies operations and lowers infrastructure overhead. From our experience running large-scale legacy email services, Mail/HTTPS uses up to 80% fewer resources than an equivalent legacy email setup, delivering significant cost savings and drastically reducing environmental impact.</p>
<h2 class="atx" id="complexity">Complexity</h2>
<p>Email, the original killer-app, is a cornerstone of internet communication, yet the traditional push-based SMTP model is increasingly out of step with modern needs. Although many protocol updates (RFCs) have attempted to address issues like spam, phishing, authenticity, reputation and security, these challenges have simply grown in scale alongside email’s overall growth. Yet email use, despite all the negative predictions, just keeps growing.</p>
<p>Progress remains slow because spam filtering conflicts with privacy demands, and spammers rapidly adapt to every new measure. Email hosting is just becoming both more complex and more expensive, without a solution in sight.</p>
<p>At the same time, email remains crucial to our digital world. It underpins account creation, commercial transactions, and serves as a universal online identity. However, modern email infrastructure, largely dominated by three major providers, has grown so complex that control is increasingly becoming centralized. This threatens the open, democratic principles upon which the Internet was built.</p>
<h2 class="atx" id="deliverability">Deliverability</h2>
<p>In legacy email context, deliverability is often framed as a top priority - essentially measuring how easily senders can inject emails into our inboxes. Ironically, this contradicts what recipients truly want: by any reasonable standard, we should control what arrives in our inboxes. Yet push-based email grants senders (and their infrastructure) a disproportionate ability to reach us, making filters, blacklists, bounces, and other band-aid solutions a necessity.</p>
<p>It’s time to let go of these obsolete ideas and workarounds.</p>
<p>Mail/HTTPS flips this dynamic entirely. Because it’s pull-based, we, the readers, decide whose messages we retrieve and when. The concept of “deliverability” fades away: the inbox control belongs to us, not to the senders or any middlemen.</p>
<h2 class="atx" id="address-secrecy">Address Secrecy</h2>
<p>In legacy email systems, preserving the secrecy of email addresses is vital, especially for famous individuals, sought-after institutions, and public figures. Exposed email addresses are susceptible to harvesting, spam, phishing, ransomware, and unsolicited messages, leading to significant privacy concerns and potential security risks.</p>
<p>In Mail/HTTPS systems exposing an address does not pose any risks. Unlike in legacy email, knowing the recipient address does not grant access to the inbox. This distinction ensures a higher level of security and privacy for users, allowing them to share their addresses publicly with confidence.</p>
<h1 class="atx" id="the-new-terminology">The New Terminology</h1>
<p>Mail/HTTPS is designed to work just like traditional email, so there’s no need to build entirely new email clients or relearn how to communicate. While it maintains familiar functionality, it introduces important changes in terminology for the better, making the email experience more intuitive and user-friendly.</p>
<h2 class="atx" id="authors-and-readers">Authors and Readers</h2>
<p>Unlike legacy email, where terms "senders" and "recipients" are commonly used, suggesting a one-way action, Mail/HTTPS employs a passive terminology of "authors" and "readers". In this system, authors compose messages and share them within their own environment with the public or specific readers only. Readers, on the other hand, can retrieve messages from authors, if interested in the author and their messages.</p>
<p>Unlike legacy email, where terms "senders" and "recipients" are commonly used, suggesting a one-way action, Mail/HTTPS employs a passive terminology of "authors" and "readers". In this system, authors compose messages and share them within their own environment with the public or specific readers only. Readers, on the other hand, can retrieve messages from authors, if interested in the author and their messages.</p>
<p>Such shift in terminology emphasizes a more democratic and user-centric approach to email communication, where both sides have full control over their interactions and messages.</p>
<h2 class="atx" id="mail-agents">Mail Agents</h2>
<p>In Mail/HTTPS, each domain designates one or more always-online mail agents, much like the Mail Exchange (MX) hosts in SMTP. However, unlike MX hosts, these agents do not accept inbound messages from others. Instead, they operate in a store-and-forward fashion, only caching outbound messages for retrieval by the intended readers.</p>
<h2 class="atx" id="email-address">Email Address</h2>
<p>Mail/HTTPS retains the traditional addressing scheme used in SMTP-email systems, with minor normalization based on de-facto accepted addressing scheme. This dual usage allows for the convenience of seamlessly transitioning between legacy and Mail/HTTPS systems without the need for significant changes in the user experience.In Mail/HTTPS, each domain designates one or more always-online mail agents, much like the Mail Exchange (MX) hosts in SMTP. However, unlike MX hosts, these agents do not accept inbound messages from others. Instead, they operate in a store-and-forward fashion, only caching outbound messages for retrieval by the intended readers.</p>
<p>In SMTP-email, addresses are known as “email” addresses because of their specific use for emailing. &nbsp;Addresses, however, serve a wider purpose beyond mere message transmission. “Email” addresses are today fundamental, easily understood digital identity, functioning as the primary identifier and recovery mechanism throughout the online realm.</p>
<p>In Mail/HTTPS, addresses represent not only users but also their online accounts, profiles, public information, broadcasts, and data. For simplicity, this document refers to what is traditionally called an “email address” simply as an “address.”</p>
<h2 class="atx" id="public-profile">Public Profile</h2>
<p>Email originated before the rise of the web and social networking platforms that now dominate our personal and professional interactions. In today’s interconnected world, having insights into someone’s current status, availability, and even location is immensely valuable. This information helps establish effective communication and provides context for interactions. Additionally, certain details extend beyond personal contact lists to be publicly visible, enhancing a person’s online presence.</p>
<p>In the context of email, it’s crucial to understand if we have the right recipients and their availability before sending messages. Without this awareness, we risk setting incorrect expectations and engaging in ineffective communication.</p>
<p>Traditional email systems were not designed to accommodate additional information about email address holders. To address this limitation, various initiatives introduced proprietary add-ons and standards like Web Finger and BIMI. These efforts aimed to provide user information, profile data, or brand images within email communications. However, widespread adoption of these solutions failed to materialize. Consequently, the most common approach to include supplementary information became adding substantial footers to emails or relying on provider-dependent profiles and profile images, lacking standardized enhanced email address information and metadata presentation.</p>
<p>Mail/HTTPS builds on previous efforts to enhance email functionality by introducing user profiles. Each address is linked to a public profile hosted at a standardized URI, which can be directly derived from the email address itself. Profile management is handled by each individual’s mail agents, providing a decentralized yet standardized method for distributing profile information.</p>
<p>Public profiles are not only operationally needed for distributing public cryptographic keys, but they also serve as a trust establishing element in the OpenEmail network.</p>
<h2 class="atx">Links</h2>
<p>Mail/HTTPS restricts messaging to parties that have mutually agreed to engage in a message exchange. Messages are shared only among authorized and consenting users, significantly enhancing privacy and security in the communication process.</p>
<p>To protect users from unauthorized messages and preserve the privacy of correspondents’ identities from third parties such as service or infrastructure providers, Mail/HTTPS creates a unique, mutual connection identifier for each email connection between two parties. This identifier, called a “link,” symbolizes the connection and is derived from the two involved addresses.</p>
<p>Mail/HTTPS links ensure that the identities of correspondents remain confidential and undisclosed to email service providers throughout the duration of the email exchange. At the same time, these links allow service providers to apply allowlisting rules, maintaining security without compromising user privacy.</p>
<h2 class="atx" id="broadcasts">Broadcasts</h2>
<p>SMTP-based email started as a one-to-one system but was later adapted for multiple recipients without properly addressing secure broadcasting.</p>
<p>However, broadcasting is crucial for both businesses and individuals looking to reach larger audiences - when those recipients agree to receive messages. Because SMTP has no built-in solution for mass messaging, users depend on external “mail blasting” services, which only add to the abuse, complexity, and inefficiency.</p>
<p>Mail/HTTPS bridges this gap with a pull-based system, much like RSS. Instead of pushing messages, authors simply post content, and readers subscribe or unsubscribe at will—using just the author’s address. This approach eliminates the need for broadcasters to manage subscriber lists and ensures that only consenting readers receive messages.</p>
<h2 class="atx" id="encryption">Encryption</h2>
<p>In Mail/HTTPS, private messages are protected by public-key cryptography. Each user’s public encryption key is published in their profile, allowing authors to securely encrypt messages so only the intended readers - who hold matching private keys - can decrypt them.</p>
<p>For messages with multiple readers, Mail/HTTPS uses hybrid encryption:</p>
<ul>
<li><p>A random key is generated to symmetrically encrypt the message content.</p>
</li>
<li><p>The random key is then encrypted separately with each reader’s public key.</p>
</li>
</ul>
<p>Because the same random key also encrypts metadata, every part of a private message remains fully confidential, preventing unauthorized access or data leaks.</p>
<p>Only private messages in Mail/HTTPS are encrypted, ensuring that sensitive communications remain confidential and readable only by the intended readers. Broadcasts, on the other hand, are intended for public or semi-public sharing and therefore remain unencrypted, allowing anyone to access or follow them.</p>
<h2 class="atx" id="signing">Signing</h2>
<p>Encryption alone ensures that only the intended readers can decrypt a message, but it does not guarantee that the message truly comes from the claimed author. To address this, every Mail/HTTPS message - private or broadcast - must include a signature generated by the author’s private signing key. Readers validate this signature using the corresponding public signing key found in the author’s profile.</p>
<p>Valid signature confirms that the message genuinely originates from the stated author and has not been altered in transit.</p>
<h2 class="atx" id="keys-rotation">Keys Rotation</h2>
<p>Encryption and signing key pairs are not meant to be permanent and are periodically rotated (replaced by new pairs). During rotation, the old public signing key remains accessible in the user’s profile alongside the new key, ensuring that any still-pending messages can be properly authenticated. The old encryption key on the other hand does not need to stay public once rotation is complete.</p>
<p>Rotation is initiated by the user’s email clients (with explicit user confirmation) and is automatically synchronized across authenticated devices, maintaining security without disrupting ongoing communications.Valid signature confirms that the message genuinely originates from the stated author and has not been altered in transit.</p>
<h2 class="atx" id="authentication">Authentication</h2>
<p>Legacy email primarily relies on password authentication, and while alternative mechanisms have been proposed, most email clients offer little to no support for them.</p>
<p>Weak or reused passwords lead to frequent account compromises, data leaks, and spam-related abuses. Since email doubles as a universal online identity, a stolen password can jeopardize an entire digital life, not just message content.</p>
<p>Mail/HTTPS eliminates passwords. Instead, it uses the private keys as proof of identity. These keys remain on trusted devices, rarely needing to be typed or transferred, which significantly reduces the attack surface for malicious actors.</p>
<h2 class="atx" id="notifications">Notifications</h2>
<p>In a pull-based system like Mail/HTTPS, readers must periodically check (or “poll”) their contacts’ mail agents for new messages. While this ensures privacy and control, frequent polling can be inefficient and is generally used only on a schedule or on demand.</p>
<p>To enable first contact and optimize the retrieval of new messages, Mail/HTTPS provides a lightweight notification mechanism. When an author’s email client uploads a message to the author’s mail agent, it also sends direct notifications to each intended reader’s mail agent. These notifications alert the reader to new content without revealing any actual message data.</p>
<p>If a reader has never communicated with the author before, the notification is treated as a contact request once the reader’s email client validates it. Only after the reader approves this request can the actual messages be retrieved. Readers can also choose to refuse notifications from unknown addresses by configuring their mail agents accordingly.</p>
<h2 class="atx" id="message-lifetime">Message Lifetime</h2>
<p>In SMTP-based systems, message delivery is typically attempted for up to 72 hours. If delivery fails during that window, the message “bounces” back to the sender. Once delivered, it sits in the recipient’s mailbox indefinitely - yet there’s no direct proof the user actually read it. This gap has led to “hacks” like web-bugs or trackers embedded in HTML messages.</p>
<p>Mail/HTTPS handles message lifetime differently by caching each message for at least 7 days. Readers can retrieve the message multiple times from any device within this period. If they never pick it up, the message simply doesn’t reach them, and the author sees that it went unread, providing a privacy-friendly form of feedback without disclosing any personal information about the reader’s environment or actions.</p>
<h2 class="atx" id="storage-separation">Storage Separation</h2>
<p>Legacy email was originally built on simple remote file transfers, creating a tight link between message delivery and storage. For SMTP email to function, the provider’s online storage effectively serves as the final destination. This setup applies the same security measures to both transfers and archives, which introduces unnecessary complexity and vulnerabilities.</p>
<p>Mail/HTTPS concerns itself only with transfers of messages, just like HTTP(S) on the web: the delivery destination is each user’s device. Should the user want to sync messages to an online archive, they can do so via their local email client, choosing any compatible service they prefer.</p>
<h2 class="atx" id="multiplicity">Multiplicity</h2>
<p>In contrast to social media platforms which typically limit users to a single identity, Mail/HTTPS natively allows usage of multiple profiles through multiple addresses.</p>
<p>Each address has its own single distinct profile and separate addresses allow users to create and manage different personas for various contexts. This separation of profiles empowers users to maintain distinct presentations for private, fun, casual, and professional interactions, providing greater control over their online identity and presentation.</p>
<p>Users can adapt their communication style and information sharing based on the specific context, just by using different addresses. This is already the norm today with existing addresses, but without attached profiles, it is assumed one single persona shares the addresses. Mail/HTTPS inverts that relation.</p>
<h2 class="atx" id="flow-overview">Flow Overview</h2>
<p>Now that the building blocks are defined, we can see how they all fit together. The most basic flow of message passing from the author towards the readers is presented in the chart below.</p>
<div class="mermaid" data-processed="true"><svg id="mermaid-1740093360208" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="301" style="max-width: 381.71875px;" viewBox="0 0 381.71875 301"><style>#mermaid-1740093360208 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1740093360208 .error-icon{fill:#552222;}#mermaid-1740093360208 .error-text{fill:#552222;stroke:#552222;}#mermaid-1740093360208 .edge-thickness-normal{stroke-width:2px;}#mermaid-1740093360208 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1740093360208 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1740093360208 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1740093360208 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1740093360208 .marker{fill:#333333;stroke:#333333;}#mermaid-1740093360208 .marker.cross{stroke:#333333;}#mermaid-1740093360208 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1740093360208 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1740093360208 .cluster-label text{fill:#333;}#mermaid-1740093360208 .cluster-label span{color:#333;}#mermaid-1740093360208 .label text,#mermaid-1740093360208 span{fill:#333;color:#333;}#mermaid-1740093360208 .node rect,#mermaid-1740093360208 .node circle,#mermaid-1740093360208 .node ellipse,#mermaid-1740093360208 .node polygon,#mermaid-1740093360208 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1740093360208 .node .label{text-align:center;}#mermaid-1740093360208 .node.clickable{cursor:pointer;}#mermaid-1740093360208 .arrowheadPath{fill:#333333;}#mermaid-1740093360208 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1740093360208 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1740093360208 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1740093360208 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1740093360208 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1740093360208 .cluster text{fill:#333;}#mermaid-1740093360208 .cluster span{color:#333;}#mermaid-1740093360208 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1740093360208 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-A LE-B" id="L-A-B" style="opacity: 1;"><path class="path" d="M230.2314453125,53L241.05745442708334,59.25C251.88346354166666,65.5,273.5354817708333,78,284.3614908854167,90.5C295.1875,103,295.1875,115.5,295.1875,121.75L295.1875,128" marker-end="url(#arrowhead8910)" style="fill:none"></path><defs><marker id="arrowhead8910" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-A LE-C" style="opacity: 1;" id="L-A-C"><path class="path" d="M152.2841796875,53L141.45817057291666,59.25C130.63216145833334,65.5,108.98014322916667,78,98.15413411458333,90.5C87.328125,103,87.328125,115.5,87.328125,121.75L87.328125,128" marker-end="url(#arrowhead8911)" style="fill:none"></path><defs><marker id="arrowhead8911" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-C LE-E" style="opacity: 1;" id="L-C-E"><path class="path" d="M87.328125,173L87.328125,179.25C87.328125,185.5,87.328125,198,98.84505208333333,210.89887619333987C110.36197916666667,223.7977523866797,133.39583333333334,237.09550477335938,144.91276041666666,243.74438096669925L156.4296875,250.3932571600391" marker-end="url(#arrowhead8912)" style="fill:none"></path><defs><marker id="arrowhead8912" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-B LE-E" style="opacity: 1;" id="L-B-E"><path class="path" d="M295.1875,173L295.1875,179.25C295.1875,185.5,295.1875,198,283.6705729166667,210.89887619333987C272.1536458333333,223.7977523866797,249.11979166666666,237.09550477335938,237.60286458333334,243.74438096669925L226.0859375,250.3932571600391" marker-end="url(#arrowhead8913)" style="fill:none"></path><defs><marker id="arrowhead8913" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform="translate(295.1875,90.5)"><g transform="translate(-56.6171875,-12.5)" class="label"><rect rx="0" ry="0" width="113.234375" height="25"></rect><foreignObject width="113.234375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-B" class="edgeLabel L-LS-A' L-LE-B">upload message</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(87.328125,90.5)"><g transform="translate(-21.0234375,-12.5)" class="label"><rect rx="0" ry="0" width="42.046875" height="25"></rect><foreignObject width="42.046875" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-A-C" class="edgeLabel L-LS-A' L-LE-C">notify</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(87.328125,210.5)"><g transform="translate(-66.109375,-12.5)" class="label"><rect rx="0" ry="0" width="132.21875" height="25"></rect><foreignObject width="132.21875" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-C-E" class="edgeLabel L-LS-C' L-LE-E">fetch notifications</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(295.1875,210.5)"><g transform="translate(-54.5390625,-12.5)" class="label"><rect rx="0" ry="0" width="109.078125" height="25"></rect><foreignObject width="109.078125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-B-E" class="edgeLabel L-LS-B' L-LE-E">fetch messages</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-A-8822" transform="translate(191.2578125,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-92.7734375" y="-22.5" width="185.546875" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-82.7734375,-12.5)"><foreignObject width="165.546875" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Author via Email Client</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-B-8823" transform="translate(295.1875,150.5)"><rect rx="0" ry="0" x="-78.53125" y="-22.5" width="157.0625" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-68.53125,-12.5)"><foreignObject width="137.0625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Author's Mail Agent</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-C-8825" transform="translate(87.328125,150.5)"><rect rx="0" ry="0" x="-79.328125" y="-22.5" width="158.65625" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-69.328125,-12.5)"><foreignObject width="138.65625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Reader's Mail Agent</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-E-8827" transform="translate(191.2578125,270.5)"><rect rx="0" ry="0" x="-34.828125" y="-22.5" width="69.65625" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-24.828125,-12.5)"><foreignObject width="49.65625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Reader</div></foreignObject></g></g></g></g></g></g></svg></div>
<p>This workflow ensures user control over incoming messages - readers only receive new content from authors they trust, while authors receive clear feedback when a message is (or is not) picked up.</p>
<ol>
<li><strong>Author Composes Message</strong>: the author creates a message much like in traditional email using an OpenEmail compatible client.</li>
<li><strong>Add Readers &amp; Verify Profiles</strong>: the author adds intended readers and may check each reader’s profile for accuracy, context and status (e.g., availability).</li>
<li><strong>Upload Message</strong>: sending the message uploads it to the author’s own mail agent.</li>
<li><strong>Send Notifications</strong>: once the upload is successful, the author’s email client notifies each reader’s mail agent that a new message is available.</li>
<li><strong>Accept Notifications</strong>: by default, the reader’s mail agent accepts notifications from unknown links if user settings, defined in the public profile allow. Otherwise, it checks the link against the user’s contacts list stored on the agent. If accepted, the notifications are cached on the mail agent for the maximum allowed message lifetime, which applies also to notifications.</li>
<li><strong>Fetch &amp;&nbsp;Validate Notifications</strong>: readers’ email clients periodically fetch notifications from their mail agents. The validity and authenticity of each notification is checked, discarding failed ones.</li>
<li><strong>Fetch Known Contact Messages</strong>: if the notification comes from a known contact (present in the local address book), the reader’s client requests the new message(s) directly from the author’s mail agent. The fetched messages is validate for authenticity, decrypted and shown in the reader’s inbox.</li>
<li><strong>Handling Unknown Contacts</strong>: notifications from authors not in the address book are displayed as "contact requests,” presenting the author’s address and profile but no actual message content.</li>
</ol>
<p>Accepting contact requests will add the author's address into local contacts and execute a fetch of any pending messages from the accepted contact.
There is no explicit rejection of contact requests as the mail agents and clients automatically expire them. Mail clients may however implement own flows of silencing the contact requests.</p>
<h1 class="atx" id="email-address-1">Email Address</h1>
<p>RFC5322 email addresses have a very liberal format due to historical reasons and long-obsolete features. Mail/HTTPS uses a simplified, reduced address format which curbs unnecessary challenges in validating and parsing, and with it minimizes discrepancies between different systems.</p>
<p>This simplified address format below, commonly in use today, stood the test of time and is adopted by Mail/HTTPS. Mail/HTTPS concerns itself only with transfers of messages, just like HTTP(S) on the web: the delivery destination is each user’s device. Should the user want to sync messages to an online archive, they can do so via their local email client, choosing any compatible service they prefer.</p>
<pre><code class="fenced-code-block">addr-spec         = local-part "@" hostname
local-part        = (letter | digit) {alphanumeric-char}
alphanumeric-char = letter | digit | "-" | "+" | "." | "_"
letter            = "A" | "B" | ... | "Z" | "a" | "b" | ... | "z"
digit             = "0" | "1" | ... | "9"</code></pre>
<p>Some valid examples follow.</p>
<pre><code class="fenced-code-block">john.doe@open.email
john+tag@mymail.com
this_is_a_valid_email_address@group.example.com
george-work@who.com
jeff.kloster@bigco.org</code></pre>
<h2 class="atx" id="character-set">Character Set</h2>
<p>Just as protocols establish standardized methods for communication, the defined character set for addresses serves as a foundational standard. Building on lessons learned from legacy email systems, <em>Mail/HTTPS prohibits the use of Unicode characters in addresses</em> to enhance both security and communication simplicity.</p>
<p>ASCII is universally supported by keyboards worldwide, ensuring that everyone can easily type the same address. As such Mail/HTTPS addresses exclusively use ASCII character subset.</p>
<h2 class="atx" id="local-part">Local Part</h2>
<p>The local-part of a Mail/HTTPS address, referring to the part before the @ sign, is case-insensitive and must not exceed a maximum length of 256 characters.
Only four special characters are allowed, (dot, dash, plus, underscore), but local part may not start or end with a special character, nor can special characters be consecutive.</p>
<h2 class="atx" id="domain-part">Domain Part</h2>
<p>The domain portion of an address functions as an identifier for the internet host from which messages are to be retrieved. It is understood as the explicit DNS label. The domain portion may not be an IP address.</p>
<h2 class="atx" id="display-name">Display Name</h2>
<p>Mail/HTTPS addresses intentionally do not include display names in the addresses as these have been greatly misused in SMTP based email. The display name of an address must be retrieved from its public profile.</p>
<h1 class="atx" id="links-1">Links</h1>
<p>The link is generated by taking two addresses, lowercasing them, ordering them alphabetically, concatenating them, and then applying the bare SHA2 hash function defined in RFC 6234, with its result represented in hex encoding. &nbsp;</p>
<p>The use of SHA2 hash function ensures that the original addresses are transformed into irreversible, fixed-length hash values, protecting the correspondents' identities from direct exposure to the email service providers.</p>
<p>The resulting hash must be considered case insensitive. The deliberate omission of a hashing salt is intentional as utilizing common connection identifiers between two parties allows for efficient access rights determination and facilitates the discovery of network connections, as further elaborated in this document.</p>
<p>Pseudo-code for generating such links follows.</p>
<pre><code class="fenced-code-block">FUNCTION GenerateConnectionIdentifier(address1, address2):
    # Normalize the email addresses
    normalizedAddress1 = ToLowerCase(Trim(address1))
    normalizedAddress2 = ToLowerCase(Trim(address2))

    # Sort the addresses alphabetically
    IF normalizedAddress1 &lt; normalizedAddress2 THEN
        sortedAddress1 = normalizedAddress1
        sortedAddress2 = normalizedAddress2
    ELSE
        sortedAddress1 = normalizedAddress2
        sortedAddress2 = normalizedAddress1
    END IF

    # Concatenate the sorted addresses without separators
    concatenatedString = sortedAddress1 + sortedAddress2

    # Calculate the SHA-256 hash of the concatenated string, returning binary
    hash = SHA256(concatenatedString)

    # Return hexadecimal representation of the SHA256 binary
    hashHex = ConvertToHex(hash)    
    RETURN hashHex
END FUNCTION</code></pre>
<p>An example of given data follows, illustrating symmetrical property of such links.</p>
<pre><code class="fenced-code-block">GenerateConnectionIdentifier('user2@Domain2.tld', 'USER1@domain1.tld') ==
GenerateConnectionIdentifier('user1@domain1.tld', 'user2@domain2.tld') == 
'c841f291d745ae1d3af3bbd4f86e1c184c6c1e6cdd8ed77a64316e12ed0f6a19'</code></pre>
<h1 class="atx" id="mail-agent">Mail Agent</h1>
<p>The underlying architecture of Mail/HTTPS functions as a store-and-forward system using always online mail agents, similar to the Mail-Exchange (MX) relays of SMTP based email. This approach is vital for supporting asynchronous communication, enabling messages to be authored and read at different intervals.</p>
<p>Unlike SMTP-email systems that rely on Mail Transfer Agents (MTAs) for message relaying, which involve at least one additional message retransmission, Mail/HTTPS agents do not relay messages further. Mail/HTTPS agents receive messages from users (authors) over HTTPS and store them locally until the designated readers retrieve them and before message expiry time.</p>
<p>The HTTP protocol was designed for this exact usage and is conveniently utilized in Mail/HTTPS. Message transmission is achieved through a single HTTP upload and single download per reader, simplifying the process and reducing the risk of message loss or delay. Additionally, messages of any size are instantly available upon upload.</p>
<h2 class="atx" id="discovery">Discovery</h2>
<p>To initiate communication, communicating parties must first discover location of users’ mail agents.</p>
<p>SMTP based email relies heavily on DNS records to discover the email destination of a given domain, through lookup of MX records. In Mail/HTTPS however, the discovery method serves the opposite purpose, to deduct the source location from where to retrieve messages, profile information for a given address, and finally - where to deliver notifications. Reversing the flow aids authenticity validation &nbsp;by retrieving messages directly from the origin via strict HTTPS. This may be further improved with a DNSSEC deployment for the domain.</p>
<p>Mail/HTTPS intentionally does not use pure DNS based discovery. SMTP email predates the web and is incompatible with its document sharing ideas. To this day, direct interaction with SMTP email services from the web is not possible, which also is fortunate due to its security model.</p>
<p>To support new interactions, Mail/HTTPS is a web-native, and it can fully be integrated into the web and the browser, securely, from discovery up to message retrieval.</p>
<p>To discover responsible mail agents for an address, mail clients check for existence of a file at a well-known URI, deduced from the host part of a given address. Well-known URIs are defined in <a href="https://datatracker.ietf.org/doc/html/rfc8615">RFC8615</a>.</p>
<p>For a given address <em>LOCAL_PART@HOST_PART</em>, the Mail/HTTPS well-known file is attempted at the following URIs in fail-over manner:</p>
<pre><code class="fenced-code-block">HTTPS GET https://HOST_PART/.well-known/mail.txt
HTTPS GET https://mail.HOST_PART/.well-known/mail.txt</code></pre>
<p>The well-known URI is retrieved over strict HTTPS over a trusted connection. Contents served over an insecure connection are ignored.</p>
<p>The configuration file is a simple text file with host-names of delegated mail agents on each line. If the configuration file is present and valid, its content is read to determine possible Mail/HTTPS service delegation.</p>
<p>Multiple mail agent host-names may be listed. If multiple host-names are listed, only the first three valid hosts are considered in the order listed. Invalid host names are ignored.</p>
<p>Each line of the well-known file is trimmed for surrounding white space before being considered. Empty lines and those starting with a hash (#) are ignored as comments and white space.</p>
<p>If no well-known files are available or no valid mail agents are determined a final attempt for mail agent is assumed a host-name <em>mail.HOST_PART</em>, a subdomain mail of the <em>HOST_PART</em> in the email address.</p>
<p>For a selected host-name <em>MAIL_AGENT_HOSTNAME</em> to be considered a valid mail agent for a <em>HOST_PART</em>, the host must respond with an HTTP OK status 200 to a domain delegation check.</p>
<pre><code class="fenced-code-block">HTTPS HEAD https://MAIL_AGENT_HOSTNAME/mail/HOST_PART</code></pre>
<p>All determined valid host-names are assumed to have a copy of all users data (profile, links, etc.).</p>
<p>Upon authoring messages, mail clients&nbsp;respect the mail agent delegation setting and store authored messages on at least one of the listed mail agent hosts, respecting order in upload attempts.</p>
<p>When querying and retrieving messages, all mail agent host-names listed in the well-known file are queried.</p>
<p>An example .well-known delegation file is given below.</p>
<pre><code class="fenced-code-block">mail.otherdomain1.tld
otherdomain2.tld</code></pre>
<p>In the example above, the Mail/HTTPS service is delegated to hosts <em>mail.otherdomain1.tld</em> and <em>otherdomain2.tld</em>: </p>
<ul>
<li><p>authored messages are uploaded to both hosts</p>
</li>
<li><p>when listing messages, readers query both hosts</p>
</li>
<li><p>when profile updates, both mail agents are updated too</p>
</li>
</ul>
<h2 class="atx" id="optimal-delegation">Optimal Delegation</h2>
<p>Discovery prioritizes well-known file and only falls back to the mail subdomain in case the file is not available. To optimize this discovery, it is optimal to use the service on the mail subdomain and include that host-name in the well-known file. Should the web service serving the well-known file be unavailable, the assumed subdomain would still allow service access.</p>
<h1 class="atx" id="public-profile-1">Public Profile</h1>
<p>The public email profile is a plain text file in which each line contains a field as a key-value pair. The pairs are separated by a single colon character, with the key and its corresponding value. The order of the fields in the profile does not matter and the field keys are case insensitive.</p>
<p>It is recommended that profile total size does not exceed 64KB. If this size limit is exceeded, the clients are permitted to truncate it as needed by dropping fields, but not less than the maximum guaranteed size. The actual maximum size is left to mail clients to determine or configure.</p>
<p>The profile always contains the mandatory, functional fields. If any of the mandatory fields is missing, the profile is considered invalid. Profile usually also contain additional, optional fields.</p>
<h2 class="atx" id="profile-location">Profile Location</h2>
<p>The user's profile is served by the user's mail agents. The profile is available over HTTPS for public GET requests requiring no authentication.</p>
<p>For a given address <em>LOCAL_PART@HOST_PART</em> and <em>MAIL_AGENT_HOST</em>, the profile is expected at the path below.</p>
<pre><code class="fenced-code-block">HTTPS GET https://MAIL_AGENT_HOST/mail/HOST_PART/LOCAL_PART/profile</code></pre>
<h2 class="atx" id="required-fields">Required Fields</h2>
<p>Public email profiles offer more than just convenience. they also play a crucial role in facilitating message encryption and validation through the exposure of public cryptographic keys.</p>
<p>A standard public email profile should include, at a minimum, the following essential field which are never empty.</p>
<ul>
<li><p><strong>Name</strong>: represents the display name associated with the address. The name helps identify the user or entity behind the address. Unlike in the email addresses, UTF8 is accepted. In legacy email, display name was typically written as part of the address as *"name" &lt;address&gt;*. </p>
</li>
<li><p><strong>Signing-Key</strong>: provides information about the user's public signing key, utilized to prove authored message authenticity, as well to authenticate the user. Digital signatures enable readers to validate that a message indeed originated from the claimed sender and has remained unaltered during transmission. The following attributes hold the key data:</p>
<ul>
<li><p>"<em>id</em>": key-pair identifier, common for the private and public key, uniquely identifying the key pair</p>
</li>
<li><p>"<em>algorithm</em>": is the signing algorithm for which the key is suitable. By default, Mail/HTTPS uses algorithm which will be assumed if the attribute is not present.</p>
</li>
<li><p>"<em>value</em>": contains the base64 encoded public signing key data.</p>
</li>
</ul>
</li>
<li><p><strong>Updated</strong>: is the ISO 8601 UTC formatted timestamp indicating the time of the last profile update. When using multiple agents, the profile timestamp permits to identify failed synchronizations.</p>
</li>
</ul>
<p>An example minimal profile file follows.</p>
<pre><code class="fenced-code-block">Name: Curious George 🍌
Signing-Key: algorithm=ed25519; value=AwzDTCM2GQu56oyFrek0XskQ5FbVHYD8TaFGm/w/kqc=
Updated: 2023-10-24T19:04:31Z</code></pre>
<h2 class="atx" id="optional-fields">Optional Fields</h2>
<p>Allowing profile owners to freely choose all attributes would result in unstructured data that would pose challenges for programmatic utilization.  Mail/HTTPS defines a set of optional profile attributes which have defined meaning.</p>
<p>The profile attributes do not repeat unless explicitly stated. If non-repeatable attributes are found more than once, only the first occurrence is considered.</p>
<p>All attributes within the user profiles are expected to be and presented in plaintext format. Clients never interpret fields for formatting and always present the raw field.</p>
<p>Exhaustive list of defined fields follows.</p>
<ul>
<li><strong>About</strong>: provides a brief description or summary of the profile owner's background, interests, or personal statement. It is a free-form field.</li>
<li><strong>Address-Expansion</strong>: if the address serves as a grouping of other addresses, or is a pointer for "forwarding" further, this fields holds comma separated destination addresses. If the profile address is meant to receive a copy too, it is expected to be included in the expansion list.</li>
<li><strong>Away</strong>: if set, the field indicates that the user may not read messages until the away status is removed. Mail clients warn authors from authoring messages for away readers. Address-Expansion field can be used for indicating delegations.</li>
<li><strong>Away-Warning</strong>: if set, along with Away, an attempt to author a message brings up this warning in email clients.</li>
<li><strong>Birthday</strong>: indicates the date of birth of the profile owner in <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO 8601</a> format (YYYYMMDD).</li>
<li><strong>Books</strong>: lists literary works or genres that the profile owner likes to read. It is a free-form field.</li>
<li><strong>Department</strong>: denotes the specific department or division within the organization where the profile owner works. It is a free-form field.</li>
<li><strong>Education</strong>: provides information about the educational background of the profile owner, including schools attended and degrees earned. It is a free-form field.</li>
<li><strong>Encryption-Key</strong>: This field holds the user's public encryption key, required for decrypting messages addressed to the user. Only intended readers can decrypt and read private messages' contents, providing a high level of confidentiality and data protection. An empty or non-present encryption key field indicates that the profile does not accept incoming messages, a feature typically reserved for "no-reply" addresses. The following attributes hold the key data.
  • "<em>id</em>": key-pair identifier, common for the private and public key, uniquely identifying the key pair
  • "<em>algorithm</em>": indicating the encryption algorithm for which the key is suitable. By default, Mail/HTTPS uses <em>curve25519xsalsa20poly1305</em> algorithm which will be assumed if the attribute is not present.
  • "<em>value</em>": contains the base64 encoded public encryption key data.</li>
<li><strong>Gender</strong>: represents the gender identity or gender expression of the profile owner. It is a free-form field.</li>
<li><strong>Interests</strong>: lists hobbies, activities, or topics of interest that the profile owner has indicated. It is a free-form field.</li>
<li><strong>Job-Title</strong>: describes the job title or position held by the profile owner within their organization. It is a free-form field.</li>
<li><strong>Languages</strong>:&nbsp;indicates the languages spoken or understood by the profile owner. It is a free-form field.</li>
<li><strong>Last-Seen-Public</strong>: a special, configuration field indicating whether the mail agent should track and make public the time of last email action. Possible valid values are "<em>Yes</em>" and "<em>No</em>". The field assumes value "Yes" if not present or invalid.</li>
<li><strong>Last-Signing-Key</strong>: provides user's previous signing key and is present after key rotations. The field serves the purpose of verifying messages that were authored during key rotations, as well verifying the user's own API requests on mail agents that are still awaiting key updates. Unlike the signing key, the last encryption key is published rotations and is not present in the profile. Temporary storage of the last encryption key is responsibility of email clients.</li>
<li><strong>Location</strong>: may indicate the geographical location such as address or GPS coordinates of the profile owner. It is a free-form field.</li>
<li><strong>Mailing-Address</strong>: represents the physical address or mailing address of the profile owner. Not to be confused with profile's Mail/HTTPS address which is implicit and not required in the profile. It is a free-form field.</li>
<li><strong>Movies</strong>: lists films or movie genres that the profile owner enjoys. It is a free-form field.</li>
<li><strong>Music</strong>: indicates the profile owner's preferred music genres, artists, or songs. It is a free-form field.</li>
<li><strong>Notes</strong>: allows for additional remarks or notes about the profile owner, such as preferences, interests, or specific instructions. It is a free-form field.</li>
<li><strong>Organization</strong>: denotes the name of the company, organization, or institution the profile owner is affiliated with. It is a free-form field.</li>
<li><strong>Phone</strong>: the telephone contact numbers associated with the profile owner. It is a free-form field.</li>
<li><strong>Public-Links</strong>: indicates whether others can publicly query for existence of a link among user's contacts. It serves as a way to discover connections within network.</li>
<li><strong>Places-Lived</strong>: information about the profile owner's previous or current places of residence or significant locations in their life. This field is free-form, meaning that there are no specific formatting requirements or constraints imposed. Users have the flexibility to input the relevant location data in a way that best suits their preferences, allowing for a customizable representation of their lived experiences and important geographical information.</li>
<li><strong>Public-Access</strong>: indicates whether the profile owner accepts notifications from unknown links as contact requests. Mail agents of the profile owner implement this policy upon notifications requests. Possible values are "<em>Yes</em>" and "<em>No</em>". The field assume default value "<em>Yes</em>" if not present or invalid.</li>
<li><strong>Relationship-Status</strong>: a free-form field indicating the current relationship status of the profile owner (e.g., single, <em>in a relationship</em>, <em>married</em>, <em>looking</em>, etc.).</li>
<li><strong>Sports</strong>: a free-form field, may lists sports activities or teams that the profile owner follows or participates in.</li>
<li><strong>Streams</strong>: a coma separated collection of free-form stream tags that readers can use to filter messages during the message pulling process. These tags allow for flexible categorization and organization of messages and can include various labels such as for example "<em>~family-photos</em>", "<em>~notes</em>", "<em>~events</em>", "<em>~location</em>".</li>
<li><strong>Status</strong>: provides the current status message or context of the profile owner. It is a free-form field.</li>
<li><strong>Website</strong>: lists the website(s) associated with the profile owner, as a free-form field.</li>
<li><strong>Work</strong>: provides details about the professional work experience of the profile owner. It is a free-form field.</li>
</ul>
<h2 class="atx" id="unstructured-fields">Unstructured Fields</h2>
<p>Any undefined field present in the user's profile is considered custom profile field. Such custom fields are allowed, taken that the mail clients present them after the reserved fields.</p>
<h1 class="atx" id="public-profile-image">Public Profile Image</h1>
<p>Each address may provide a profile image to be used as a thumbnail as well as profile banner. It serves to clearly identify the user of a given address. It is recommended for all addresses to provide a profile image as it helps build trust.</p>
<p>Just as the profile, the profile image can be served only over HTTPS. Profile images served over insecure connections are ignored.</p>
<p>The profile image format can be one of the following: JPEG, GIF, PNG, or WebP and should not exceed 512KB in size. If this size limit is exceeded or the image is invalid, the profile image can be omitted for a placeholder in the mail client at client's discretion.</p>
<p>The profile image should be square, of equal height and width. The recommended image size is 400x400 pixels. The mail agents do not provide alternative sizes of the profile image. It is the responsibility of mail clients to retrieve, resize and cache the profile images.</p>
<h2 class="atx" id="profile-image-location">Profile Image Location</h2>
<p>The user's profile image is served by the user's mail agents. The profile is available over HTTPS for public GET requests requiring no authentication.
For a given address <em>LOCAL_PART@HOST_PART</em> and <em>MAIL_AGENT_HOST</em>, the profile is expected at the path below.</p>
<pre><code class="fenced-code-block">HTTPS GET https://MAIL_AGENT_HOST/mail/HOST_PART/LOCAL_PART/image</code></pre>
<h2 class="atx" id="privacy-concerns">Privacy Concerns</h2>
<p>In SMTP-email, images are commonly used within HTML messages as "web-bugs" to track events such as opening, as well reader's final IP address and location. Mail/HTTPS profile images are not tied to any particular message and do not invade privacy of the corresponding parties.</p>
<h1 class="atx" id="encryption-andamp-signing">Encryption &amp; Signing</h1>
<p>Mail/HTTPS relies on a hybrid combination of asymmetric and symmetric ciphers. The message content and metadata in private messages is first encrypted using symmetric ciphers, effectively avoiding duplication of data when multiple readers are present. The strong random symmetric cipher key used is then encrypted using asymmetric ciphers using each reader's public encryption key.</p>
<p>Both public (broadcasts)&nbsp;and private messages are signed using asymmetric keys.</p>
<p>To ensure adaptability to future developments and prevent the need for versioning, Mail/HTTPS does not lock itself into specific algorithms. It anticipates that algorithms will advance over time and change will be necessary. What remains consistent is the utilization of a combination of asymmetric and symmetric ciphers.</p>
<p>The headers of Mail/HTTPS messages list which ciphers were used for encrypting and signing payloads.</p>
<p>Minimum required algorithms are <em>sha256</em> for checksum, <em>xchacha20poly1305</em> for symmetric encryption, <em>curve25519xsalsa20poly1305</em> for asymmetric encryption and <em>ed25519</em> for signing. All of these algorithms are conveniently available as a part of the popular <a href="https://libsodium.gitbook.io">LibSodium</a> library.</p>
<h2 class="atx" id="key-ids">Key IDs</h2>
<p>Key pairs used for encryption and signing are not meant to be permanent.&nbsp;As described previously, the keys are rotated periodically by email clients.</p>
<p>During such rotations, at least for the maximum message lifetime, two key pairs may be referenced. To distinguish between the two in email clients, key identifiers are introduced. These identifiers are meant to be simple and common, to avoid their usage in determining reader identity. Ideally, they are nothing but simple incremental counters starting from 1.</p>
<h2 class="atx" id="fingerprints">Fingerprints</h2>
<p>Mail/HTTPS, as we will see later in this document, needs to compare keys. Instead of using the full keys in comparison, only sha256 hashes are compared . We simply call those hashes key fingerprints.</p>
<h2 class="atx" id="anonymous-asymmetric-encryption">Anonymous Asymmetric&nbsp;Encryption</h2>
<p>Asymmetric encryption is used for encrypting the symmetric encryption key which is previously used for sealing the message payload and headers.</p>
<p>Instead of using author's own private encryption key, we use a newly generated anonymous asymmetric encryption key pair to encrypt the symmetric key. The anonymous public key is embedded in the cipher text. Such anonymization shifts the responsibility for the message to the reader, as solely the reader's private key is able to decrypt the message without the need for author's public key. In addition, it theoretically permits that author and reader use different encryption algorithms, as long as they are both based on asymmetric public key cryptography.</p>
<p>Such encryption using ephemeral keys does not authenticate messages. Authenticity is instead determined through signatures.</p>
<p>Libsodium library implements a ready primitive called <em>Anonymous Box</em>, based on <em>Curve25519</em>, <em>XSalsa20</em> and <em>Poly1305</em> for asymmetric key encryption of small data, which Mail/HTTPS conveniently takes as default and minimum asymmetric encryption algorithm.</p>
<h2 class="atx" id="large-message-handling">Large Message Handling</h2>
<p>Mail/HTTPS supports messages of any size. However, very large messages can be challenging to decrypt and store on devices with limited processing power or storage. Although streaming encryption is compatible with Mail/HTTPS, it doesn’t allow parallel decryption for large payloads.</p>
<p>To address this, Mail/HTTPS splits large messages (such as those with big attachments) into chunks of up to 64 MB each, which are encrypted individually. This design accommodates both ends of the hardware spectrum, supporting low-powered devices which can decrypt smaller chunks more comfortably without running out of memory, just as more capable devices which can speed things up by parallelizing both the download and decryption of individual chunks.</p>
<h2 class="atx" id="signing-1">Signing</h2>
<p>Mail/HTTPS messages embed author signatures of both headers and payload. The same are computed as cryptographic signatures of binary <em>sha256</em> checksum of the given data. Care should be taken not to sign hexadecimal data representation instead of the binary checksum data.</p>
<h1 class="atx" id="message-object">Message Object</h1>
<p>Mail/HTTPS objects are accessible through public URIs (Uniform Resource Identifiers). These URIs provide means for locating and retrieving the Mail/HTTPS objects, ensuring they can be accessed and interacted with by readers.</p>
<p>The transportation of a message object is accomplished within a single HTTPS request. A message object consists of both metadata and payload, allowing for the inclusion of relevant information about the message as well as the actual content being transmitted.</p>
<p>Message objects in Mail/HTTPS can be classified as either private or public. Public message objects are accessible to everyone. They lack specified readers and are signed by the author to ensure authenticity. These messages are akin to broadcasts, openly available to anyone interested in their content.</p>
<p>On the other hand, private message objects are encrypted and can only be accessed by designated readers specified by the author. This encryption ensures the confidentiality and security of the message content, restricting access to authorized readers only.</p>
<p>The metadata of a Mail/HTTPS object is efficiently transferred using HTTP headers, enabling a convenient and streamlined transmission of essential information about the message. While transfer-related metadata is not encrypted, message-specific data, including the author, readers, subject, and other confidential information, may be encrypted to ensure privacy and security during transmission.</p>
<h2 class="atx" id="lifetime">Lifetime</h2>
<p>Broadcast messages have the minimum duration of 7 days (168 hours) from the time of the upload. If messages are pinned, they are stored permanently and offered to readers in each list request. The message pinning is achieved via the header Message-Pinned presence in the message envelope. There is no limit on the number of pinned messages.</p>
<p>Private Mail/HTTPS messages of most generic category "personal" have a default duration of 7 days (168 hours) from the time of the upload on the mail agent. Authors and their mail clients can decide the actual duration of messages on mail agents. Mail agents on their own do not enforce messages duration, as the removal of private messages is exclusively reserved for mail clients. Author's mail client can be configured to automatically remove private messages collected by all designated readers.
Unlike broadcast messages, private messages cannot be pinned.</p>
<p>Should the reader be unavailable to retrieve the message during the message lifetime, author's mail client notify author of the lack of retrieval. Author may decide to re-notify the readers and keep the message for a longer period. Alternatively, author may drop the message.</p>
<h2 class="atx" id="access-rights">Access Rights</h2>
<p>Encrypted messages are only decryptable by the final readers as the decryption keys are encrypted using reader's public encryption key. As such, even public visibility of the encrypted messages would not leak any information about the readers and the content itself.</p>
<p>Nevertheless, in Mail/HTTPS, only designated readers can list and retrieve messages from author's mail agents through authenticated requests, effectively confirming pickup by the reader irrefutably. This universal identified "delivery" confirmation is crucial in official, on-the-record messaging. Its absence in SMTP-email has led to many privacy invading techniques where delivery is confirmed without the recipient consent. Mail/HTTPS makes the message pickup and delivery confirmation completely in the hands of the reader. Should the reader decide for the pickup to be executed, the delivery is confirmed using cryptography.</p>
<p>Access right evaluation and delivery confirmation is done in full anonymity on the mail agent. This is achieved through anonymized authentication where agent operators have no knowledge of the authenticating reader's identity.</p>
<p>Author's private messages awaiting pickup on mail agents provide in envelope header Message-Access a list of connection identifiers and public key fingerprints of designated readers, along with the message decrypting password encrypted anonymously with the reader's public encryption key.</p>
<h2 class="atx" id="message-id">Message-Id</h2>
<p>SMTP-email provides a considerable degree of flexibility in selecting a Message-Id, often resulting in messages being sent without a Message-Id altogether. In contrast, Mail/HTTPS mandates the use of a Message-Id, as it plays a crucial role in ensuring message retrieval. Unlike SMTP-email, where global uniqueness of Message-Ids is the norm by including the sending domain, Mail/HTTPS requires uniqueness only within the author's mail agent, permitting anonymized identifiers.</p>
<p>Message-Ids in Mail/HTTPS are hexadecimal strings, ranging from 32 to 128 characters in length, containing only numeric digits and characters A to F. Message-Ids are treated as case-insensitive, and are URL-safe within the Mail/HTTPS system.</p>
<h2 class="atx" id="payload">Payload</h2>
<p>In the Mail/HTTPS system, messages are either a body or a file payload. A message cannot contain both simultaneously.</p>
<p>Private messages undergo a robust encryption process to ensure confidentiality and integrity. The author's mail client encrypts the messages locally using a strong, randomly generated password and a symmetric cipher. For secure sharing with readers, the random password is individually encrypted for each reader. This is achieved by encrypting the password with the reader's public encryption key, obtained from the reader's public profile, and a randomly generated asymmetric key-pair. The private key involved in this encryption is discarded, while the corresponding public key is included alongside the cipher-text of the encrypted message.</p>
<p>The responsibility for message confidentiality is effectively shifted to the intended readers. Only authorized readers possessing the respective private keys can successfully decrypt and access the private message. The message content remains private and secure throughout transmission and storage.</p>
<h2 class="atx">Encoding</h2>
<p>SMTP-email uses MIME for encoding messages and allows use of character sets other than ASCII. It also permits embedding additional content into single messages. This is historical bagage and has made email messages unnecessarily complicated.</p>
<p>HTTP, on which Mail/HTTPS relies, can handle multipart bodies, but this involves complex encoding, decoding, and parsing steps. This complexity is burdensome for both server and client development and is inefficient for large files. Additionally, multipart message segments cannot be sent simultaneously, a strategy that typically speeds up data transfer.</p>
<p>Mail/HTTPS does not encode messages beyond encryption in private context. Body of messages, if present, natively supports Unicode. Embedding of additional content into messages is also not possible. Each message is either a text file body or a binary file, transferred within a single HTTP request. Messages that are related reference a parent message by its Message-Id. Email clients' user interfaces hide this implementation detail and reconstruct the single-message illusion.</p>
<h2 class="atx" id="plaintext">Plaintext</h2>
<p>Embedded message content is presented to the reader in its raw, text form, without any parsing or interpretation. If the message content is determined not to be of text content type, it it is interpreted as invalid and unsafe, without any attempts of interpreting it.</p>
<p>Mail/HTTPS forbids HTML and similar markup languages which may load remote content or mask link destinations. Any remote content can be easily linked to or included as attachment instead.</p>
<p>Clients can support a subset of MarkDown, removing support for remote content (images) and links masking. Clients can however support Base64 encoded images within MarkDown bodies. The recommended maximum size of Base64 encoded image source is 256KB, though clients can apply own limits.</p>
<h2 class="atx" id="files-attachments">Files (Attachments)</h2>
<p>Mail/HTTPS allows including files into messages, commonly considered "attachments". While SMTP-based email embeds such files into single multi-body messages, Mail/HTTPS transfers each file in a single or multiple messages referencing the parent message containing the body. Such "message-group" is expected to be downloaded in its entirety and message reconstructed in the reader's email client. The parent message serves as an anchor ("root") for the rest of the message parts and describes the message structure on author's side.</p>
<p>In a message group, there is only a single parent message which serves as a source of truth on the origin message structure. The content header Parent-Id indicates the message is not to be considered on its own and is a part of a message group. Along the same logic, any message not including a "<em>Parent-Id</em>" header is considered a representative message. A message group fragment can be referenced and presented only via the parent message and its "<em>Files</em>" header. For the relation to be established, the referencing message' "<em>Parent-Id</em>" header must match the parent "<em>Message-Id</em>", and both messages must be authored by the same user, at the very same time, using the same keys. Relation between messages in a group cannot be established between messages authored at different times or not part of the original message group.</p>
<p>No single message can contain both embedded content and file contents. Such restriction is practical as the body payload itself is indistinguishable from file payloads in messages. To provide an illusion of presence of both in reader's email client, only the parent message is expected to include a representative body, while the referencing messages provide files' contents.</p>
<p>Parent message cannot be of "<em>file</em>" type even if the embedded body is empty. Any reference to a parent of "<em>file</em>" type, containing a File header or a non-representative body is ignored. It is recommended for email clients to suggest deletion or manual inspection of such messages to the reader.</p>
<p>When a message is very large, it is split into parts which are transferred as own messages. The latter are re-assembled by readers' clients. Splitting larger files into smaller messages brings benefits of parallel message transfers.</p>
<h2 class="atx" id="size">Size</h2>
<p>Mail/HTTPS imposes no message size limitations. Any limitations are outcome of either author's own home agent service provider or reader's mail client. Considering the transient nature of messages on mail agents, the message size limit may be considerably high.</p>
<p>Nevertheless, it is recommended to keep individual messages under 64MB, effectively splitting larger messages into smaller messages. The process of splitting and reassembling is unnoticeable to the end user. With such splitting, both authors and readers benefit from faster transfers due to the parallel transfers possibility.</p>
<p>Unlike in SMTP-email, the size restrictions are not imposed by the remote reader's infrastructure. There is no guess work or trial and error when transferring large messages.</p>
<h2 class="atx" id="headers">Headers</h2>
<p>Mail/HTTPS uses standard HTTP headers for transmitting message information, separate from the message payload (content).</p>
<p>HTTP headers of the message object play a critical role in providing information about the transfer, payload, and nature of messages within the Mail/HTTPS system. These headers are essential for various purposes, including determining the authenticity of messages, establishing access rights for readers, and understanding the overall nature of the messages being exchanged.</p>
<p>Confidential metadata is encapsulated within an encrypted object present within the headers. The object is encrypted using the same password used for encrypting the message content and is found in the "<em>Message-Content-Headers</em>" HTTP header, itself anonymously encrypted using readers public key.</p>
<p>Reusing the same random password for encrypting both the content and metadata ensures consistency and simplifies the encryption process. It avoids the need for separate passwords and allows for efficient decryption of both the message content and metadata using the same shared key.</p>
<p>Headers keys are treated as case insensitive both in envelope and within embedded content headers. The headers' values are treated as case sensitive instead. The order of headers appearance is irrelevant, except for the calculation of envelope checksum, in which case the header values should be summed using the defined order in the attribute order of header "<em>Message-Checksum</em>".</p>
<p>HTTP specification does not impose headers size limitations, though many web servers and browsers do. Mail/HTTPS uses own servers and clients which permit at least 512KB of headers both in requests and responses.</p>
<h2 class="atx" id="categorization">Categorization</h2>
<p>The conventional approach to email treats all messages as equal, resulting in overloaded inboxes and the laborious task of sorting through them. Many users end up abandoning the effort and retaining all messages, which not only hinders an optimized user experience but consumes unnecessary storage, contributing to a larger carbon footprint. Consequently, methods such as content detection and AI have been employed, further increasing the processing power.</p>
<p>By pre-categorizing messages by authors, it becomes possible to enhance how mail clients display and handle these messages. Additionally, it enables better decision-making regarding whether or not to save them in archives.</p>
<p>We define standard categories for mail object below.</p>
<ul>
<li><p>"<strong>personal</strong>": messages from private circles, the default type of messages.
"chat": short messages for a less formal conversation type.</p>
</li>
<li><p>"<strong>transitory</strong>": TOTP, one time access links etc.</p>
</li>
<li><p>"<strong>notification</strong>": information of an event occurrence such as system alert, sensor information, security notification, parcel shipping status etc.</p>
</li>
<li><p>"<strong>transaction</strong>": messages related to a private or commercial transaction, such as order confirmation, receipt, refund etc.</p>
</li>
<li><p>"<strong>promotion</strong>": messages informing of new offerings, sales events etc.</p>
</li>
<li><p>"<strong>letter</strong>": official communication from organizations, government as well anything that would have been sent as postal mail. While the term "letter" may evoke the idea of a PDF format, it's important to clarify that in this context, the message type does not specifically refer to PDFs. Instead, it pertains to plain text messages where the content is expected to be in the form of plain text within the message body. It is possible to include a PDF file as an additional message of type "file," which could be associated with the "letter" message.</p>
</li>
<li><p>"<strong>file</strong>": messages containing a single file of any file type.</p>
</li>
<li><p>"<strong>informational</strong>": messages that are announcements, commonly broadcast that cannot be classified under any other categories.</p>
</li>
<li><p>"<strong>pass</strong>": messages containing a pass, such as as airplane tickets, theater tickets, invitations etc. The messages may be referenced by other messages containing pass files such as PDF, PKPASS etc.</p>
</li>
<li><p>"<strong>funds</strong>": this category serves as a placeholder for future developments and potential inclusion of such digital currency-related messages. It anticipates the possibility of incorporating messages that involve digital currency transactions, loyalty program points, or electronic cash in the future.</p>
</li>
<li><p>"<strong>encryption-key</strong>": Special messages containing a replacement private encryption key. These messages must be authored by the reader, duly encrypted and signed with current keys, and retrieved only from the user's own email agent. Email clients refuse to retrieve remote messages of other authors of this type.</p>
</li>
<li><p>"<strong>signing-key</strong>": Special messages containing a replacement private signing key. These messages must be authored by the reader, duly encrypted and signed with current keys, and retrieved only from the user's own email agent. Email clients refuse to retrieve remote messages of other authors of this type.</p>
</li>
</ul>
<h1 class="atx" id="message-envelope">Message Envelope</h1>
<p>Envelope headers are conveniently provided as HTTP headers during uploads/downloads. In private messages, they do not reveal any information about the payload or the communicating party. Broadcast (public) messages on the other hand do not attempt to hide the content or the meta-data and instead focus on origin authentication.</p>
<p>As specified in <a href="https://datatracker.ietf.org/doc/html/rfc2616">RFC2616</a>, HTTP&nbsp;header keys are case insensitive, which reflects also to Mail/HTTPS.</p>
<h2 class="atx" id="required-headers">Required Headers</h2>
<p>The following headers are mandatory in all messages.</p>
<ul>
<li><p><strong>Content-Length</strong>: standard HTTP header indicating the payload size that follows. Both agents and clients use this header to restrict the stream flow, or refuse the request altogether due to disallowed size. Both clients and agents refuse payloads without or with an invalid Content-Length header.</p>
</li>
<li><p><strong>Message-Id</strong>: the unique message identifier.</p>
</li>
<li><p><strong>Message-Headers</strong>: base64 encoded data of either encrypted headers in private messages, or of plaintext headers in broadcast messages. Expected attributes:</p>
<ul>
<li><p>"<em>value</em>": Base64 encoded headers payload</p>
</li>
<li><p>"<em>algorithm</em>": the encryption algorithm used, defaults to xchacha20poly1305, or value none if the data is not encrypted, only encoded</p>
</li>
</ul>
</li>
<li><p><strong>Message-Checksum</strong>: checksum information of the envelope headers. Since the order of headers is not guaranteed, the concatenation order used is recorded in the order attribute. Required attributes follow.</p>
<ul>
<li><p>"<em>algorithm</em>": the hashing algorithm used for calculating the checksum, defaulting to sha256</p>
</li>
<li><p>"<em>order</em>": lists the concatenation order of headers before checksum calculation , separated by a colon ":" character</p>
</li>
<li><p>"<em>value</em>": the checksum calculated on concatenated headers values without any separators in the specified order</p>
</li>
</ul>
</li>
<li><p><strong>Message-Signature:</strong> the checksum data previously calculated in the value of Message-Checksum header is here signed using author's private signing key. Note the signature is calculated on the binary checksum data, and not on the string hexadecimal value.</p>
<ul>
<li><p>"<em>id</em>": key-pair identifier, identifying the key used for signing</p>
</li>
<li><p>"<em>algorithm</em>": indicates signing algorithm used, defaulting to <em>ed25519</em></p>
</li>
<li><p>"value": the signed checksum as a Base64 encoded value</p>
</li>
</ul>
</li>
</ul>
<h2 class="atx" id="conditional-headers">Conditional Headers</h2>
<p>While the previous headers are mandatory in all messages, the following envelope headers depend on the nature of the message.</p>
<ul>
<li><p><strong>Message-Access</strong>: this header is present only on private messages and it distinguishes message from broadcasts. It contains a list of attribute groups containing connection identifiers (links), public keys and encrypted passwords for determining access rights. Each group identifies a single reader. As standard HTTP header attributes, they are are separated using a semi-column within the group while groups are coma separated. Each message has at least one access group for the author. Each reader has own access group and each group includes the attributes below.</p>
<ul>
<li><p>"<em>link</em>": the mutual connection link for the author and designated reader.</p>
</li>
<li><p>"<em>fingerprint</em>": fingerprint of the binary value of reader's public signing key, being simply the sha256 hash of the public key. </p>
</li>
<li><p>"<em>value</em>": the encrypted symmetric key, Base64 encoded. </p>
</li>
<li><p>"id": key-pair identifier, identifying the reader's key used for encryption</p>
</li>
</ul>
</li>
<li><p><strong>Message-Encryption</strong>: a future-proofing header holding the encryption information used to encrypt the payload, present only on private messages. Contains a single attribute:</p>
<ul>
<li>"<em>algorithm</em>": the encryption scheme used, defaults to <em>xchacha20poly1305</em></li>
</ul>
</li>
<li><p><strong>Message-Stream</strong>: the public stream, tag or grouping of the message, a free-form value. May be assigned by the author to the message if the message is to be tied to specific stream. Only a single stream tag is permitted.</p>
</li>
<li><p><strong>Message-Pinned</strong>: presence of this header is reserved for broadcast messages and indicates that the message should be kept until unpinned. The header has no meaning in private messages. The only valid value is "<em>Yes</em>", otherwise the header is treated as not present. Mail agents can choose to ignore this header.</p>
</li>
</ul>
<h2 class="atx" id="content-headers">Content Headers</h2>
<p>Previously described envelope contains base64 encoded and encrypted content headers of private messages or just base64 encoded of broadcasts. In both cases, the content headers are contained in the value of the envelope "<em>Message-Headers</em>" header.</p>
<p>The content headers are of the same format as the envelope headers.</p>
<h3 class="atx" id="mandatory-headers">Mandatory Headers</h3>
<p> The following headers are mandatory in all messages.</p>
<ul>
<li><p><strong>Id</strong>: the message identifier, matches the envelope "<em>Message-ID</em>" header unless the message is forwarded.</p>
</li>
<li><p><strong>Author</strong>: the address of the message author as a valid Mail/HTTPS address.</p>
</li>
<li><p><strong>Date</strong>: the authored-on date in <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO8601</a> UTC format, for example <code>2023-10-24T19:04:31Z</code></p>
</li>
<li><p><strong>Size</strong>: the size in bytes of the raw content, whether text body or file.</p>
</li>
<li><p><strong>Checksum</strong>: checksum of the raw content, whether text body or file.</p>
</li>
<li><p><strong>Subject</strong>: plain text subject line for the message.</p>
</li>
<li><p><strong>Subject-Id</strong>: unique subject identifier; equals the message identifier of messages initiating new subjects. It is used by mail clients for grouping messages under the same topic (initial subject).</p>
</li>
<li><p><strong>Category</strong>: categorization of the message.</p>
</li>
</ul>
<h3 class="atx" id="conditional-headers-1">Conditional Headers</h3>
<p>The following content headers depend on the message nature.</p>
<ul>
<li><p><strong>Readers</strong>: the addresses of the readers, comma separated. Always present in private messages, unless the message is forwarded. Author's address is not present among readers as the reader role is implicit here and explicit in envelope Message-Access header.</p>
</li>
<li><p><strong>Files</strong>: a parent message only header listing all attached files. The header gives a hint of how the original message was structured upon authoring as well how the message should be re-assembled upon retrieval. The header value is a list, composed of the following attributes in each item.</p>
<ul>
<li><p>"<em>name</em>": case sensitive file name, it does not include special or white-space characters, but the final decision on permitted filenames rests with mail clients which can sanitize and rename file names.</p>
</li>
<li><p>"<em>id</em>": the message-id of the message containing the given part</p>
</li>
<li><p>"<em>type</em>": represents the MIME type of the file.</p>
</li>
<li><p>"<em>size</em>": the file size in bytes. This attribute may be present but it is redundant with the content header Size.</p>
</li>
<li><p>"<em>part</em>": if the payload is a chunk of a larger payload, the segment number and total number of segments are expected, e.g. 2/5.</p>
</li>
<li><p>"<em>modified</em>": the file's last modification date at origin in <a href="https://www.iso.org/iso-8601-date-and-time-format.html">ISO8601</a> UTC format, for example <code>2023-10-24T19:04:31Z</code>. The modification date is used to restore the file modification date upon transfer, whenever possible.</p>
</li>
</ul>
</li>
<li><p><strong>File</strong>: if the message payload is a file (attachment) or file chunk, this header is present describing the contained file. The header is never present on parent messages. The same attributes of the items listed in the parent's Files header are permitted, but relevant only to the payload.</p>
</li>
<li><p><strong>Parent-Id</strong>: contains the "<em>Message-Id</em>" of the parent message if the payload contained should be treated as an "attached" file and part of another message.</p>
</li>
</ul>
<h1 class="atx" id="notifications-1">Notifications</h1>
<p>When an author creates a message intended for specific readers and uploads it to own home agent, the readers are informed of the new message's presence. This can be accomplished through two methods.</p>
<ul>
<li><p><strong>Polling</strong>: In this method, users periodically check all their contacts' mail agents to see if there are any updates or new messages waiting for them. They poll at regular intervals, either periodically or on-demand, to stay up-to-date with incoming messages. While not most efficient method, it doesn't rely on the reader's infrastructure. Moreover, it requires polling all contacts which may lead to delays in message delivery if polling intervals are not frequent enough. Email clients do have the freedom to implement their own polling logic according to their preferences however.</p>
</li>
<li><p><strong>Author Notifications</strong>: This method involves the author directly notifying the designated readers about the presence of new message. When the author creates a message for specific readers, the author's mail client triggers notifications to inform the readers' mail agents about the message. Using notifications is more efficient and immediate, as readers receive notifications in real-time, reducing the need for constant polling and ensuring timely message discovery. However, ithis flow depends on the availability of the readers' mail agents.</p>
</li>
</ul>
<p>Mail/HTTPS uses a combination of both methods, preferring author notifications while periodically polling the contacts.</p>
<h2 class="atx" id="payload-1">Payload</h2>
<p>Notifications are initiated from the Mail/HTTPS client of the author and sent directly to the mail agents of the readers.</p>
<p>Each notification includes the author's address, which is encrypted anonymously using the reader's public encryption key. This encrypted address serves a dual purpose:</p>
<ul>
<li><p>it's used for identifying new contact requests and</p>
</li>
<li><p>verifying the authenticity of the notification when retrieved by the reader's mail client.</p>
</li>
</ul>
<p>The notification call is publicly authenticated with the remote mail agent, requiring a signed nonce in the HTTP headers. However, this nonce is only used for verifying the signature locally. The mail agent itself is unable to independently confirm the authenticity of notifications because it lacks information about their origin.</p>
<p>If the reader configures their home agent to accept notifications exclusively from their own connection identifiers, the mail agent may decline notification requests, essentially also preventing the acceptance of new contact requests.</p>
<h2 class="atx" id="identifier">Identifier</h2>
<p>Upon accepting a notification, mail agents are expected to assign a unique, local identifier to each new notification. The notification identifier is generated locally after the acceptance of the notification and cannot be part of the incoming notification. Identifiers help mail clients keep state of already seen notifications.</p>
<p>The notification identifier is an alpha-numeric string of no more than 32 characters. The identifier may be a counter or generated random string and is unique locally for each notification of a given link.</p>
<h2 class="atx" id="lifetime-1">Lifetime</h2>
<p>Notifications are kept for at least maximum message lifetime upon being received by mail agents.</p>
<p>Should an author repeat a notification while an existing notification which is not yet seen by the reader exists, the new notification is ignored. There is always at maximum one notification per link at the mail agent.</p>
<h2 class="atx" id="verification">Verification</h2>
<p>The authenticity of notifications is not verified by mail agents and must be completed by mail clients upon retrieval. Each notification contains:</p>
<ul>
<li><p>unique notification identifier</p>
</li>
<li><p>author's encrypted address as payload</p>
</li>
<li><p>author's signing fingerprint used to deliver the notification</p>
</li>
</ul>
<p>The authenticity is verified through the following steps:</p>
<ul>
<li>checking fingerprint match with readers' public keys (actual and previous)</li>
<li>decrypting the notification payload with the reader's private key, resulting into author's address</li>
<li>ensuring author's address is a valid email address</li>
<li>ensuring link matches author's and reader (local) address</li>
<li>retrieving author's profile and comparing signing fingerprint with the one of the actual or last public signing key</li>
</ul>
<p>Should any step fail, the notification is considered bogus and is ignored. Mail clients can mark and cache bogus notifications locally up to its maximum lifetime to avoid further re-checks of the same.</p>
<h2 class="atx" id="execution">Execution</h2>
<p>Mail clients act only upon verified notifications. If the connection identifier is an existing contact, mail clients can immediately proceed to retrieving remote messages from the contact's mail agent.</p>
<p>If the connection identifier is not an existing contact, mail clients treat it as a contact request. Mail clients never retrieve messages from non-existing contacts in automatic manner. Peeking into remote messages could be allowed by mail clients at the request of the user.</p>
<h2 class="atx" id="suppression">Suppression</h2>
<p>Mail agents and clients can implement suppression for selected links, refusing or ignoring notifications. Such feature is not part of the Mail/HTTPS protocol because legacy email has thought us deny-listing does not work. </p>
<p>Suppression of a contact request is best handled in the email client itself, while the mail agent should only protect itself from excessive notifications from unlisted links.</p>
<h1 class="atx" id="special-usecases">Special Usecases</h1>
<h2 class="atx" id="key-rotations">Key Rotations</h2>
<p>TODO</p>
<h2 class="atx" id="replies">Replies</h2>
<p>TODO</p>
<h2 class="atx" id="forwarding">Forwarding</h2>
<p>TODO</p>
<h2 class="atx" id="threading">Threading</h2>
<p>TODO</p>
<h2 class="atx" id="broadcasting">Broadcasting</h2>
<p>TODO</p>
<h3 class="atx" id="direct-public-access">Direct Public Access</h3>
<p>TODO</p>
<h3 class="atx" id="public-indexing">Public Indexing</h3>
<p>TODO</p>
<h3 class="atx" id="re-broadcasting-messages">Re-broadcasting messages</h3>
<p>TODO</p>
<h3 class="atx" id="public-replies">Public Replies</h3>
<p>TODO</p>
<h2 class="atx" id="address-expansions">Address Expansions</h2>
<p>In SMTP-email, messages are often automatically forwarded to other addresses or sent to virtual alias addresses which then distribute the message to multiple recipients. Such setups hide the final readers from the author, who may have disapproved of the message distribution. Moreover, automatic forwarding breaks email authentication protections and increases likelihood of being rejected or silently dropped as spam.</p>
<p>There are valid cases for aliasing/forwarding however: </p>
<ul>
<li><p>the user may have changed address, and would like to receive messages on the new address, avoiding to monitor multiple mailboxes.</p>
</li>
<li><p>while away, messages could be delegated to a responsible substitute, a common case in business. </p>
</li>
<li><p>a copy could always be desired to the business or family partner</p>
</li>
<li><p>an archives provider could receive a copy for keeping remote archives.</p>
</li>
<li><p>a poor man's mailing list, where the list of members (readers) is always contained in one address.</p>
</li>
</ul>
<p>While SMTP-email forwarding happens on relays, Mail/HTTPS provides for similar result but directly within mail client by reading the address expansions from the address' public profile. This permits end-to-end encryption and full knowledge of the final readers by the author.</p>
<h3 class="atx" id="envelope">Envelope</h3>
<p>Envelope lists all resulting readers after the address expansions. There are no traces in the envelope of any expansion.</p>
<h3 class="atx" id="content-headers-1">Content Headers</h3>
<p>The 'Readers' content header document the address expansion by following the expanded address by a column and semi column separated list of expanded addresses. For example:</p>
<pre><code class="fenced-code-block">Readers: reader1@domain1.tld, reader2@domain2.tld, expanded.reader@domain3.tld:reader4@somewhereelse.tld;reader5@somewhereelse2.tld</code></pre>
<p>Presence of the original expansion in content headers permits authored replies to re-evaluate the expansion based on actual settings.  Expanded addresses are distinguished in mail clients.</p>
<h1 class="atx" id="https-api">HTTPS API</h1>
<p>Mail/HTTPS relies exclusively on HTTPS. Insecure requests over HTTP are not permitted.</p>
<h2 class="atx" id="authentication-1">Authentication</h2>
<p>Mail/HTTPS mandates authentication for accessing mail agents, both as an author or a reader.</p>
<p>When authenticating as author, the mail agent permits uploading and controlling messages, retrieving notifications, account as well keys management. When authenticating as reader however, authenticated treader may list and retrieve designated messages, which also confirms pick-up by the reader's identity.</p>
<p>The same authentication method can be conveniently used to both home and remote agents as it bases itself on possession of valid private keys. Mail/HTTPS authentication bases itself on HTTP authentication <a href="https://datatracker.ietf.org/doc/html/rfc7235">RFC7235</a>, with own pending scheme named "<strong>SOTN</strong>", an acronym for <strong>Signed-One-Time-Nonce</strong>.</p>
<h3 class="atx" id="sotn-scheme">SOTN Scheme</h3>
<p>The SOTN authenticating scheme expects following values to be transferred in the '<strong>Authorization</strong>' HTTP request header:</p>
<ul>
<li><p>"<strong>host</strong>" for which the nonce is intended. The host being authenticated MUST reject request for hosts not matching own hostname, as well requests repeating nonce values.</p>
</li>
<li><p>"<strong>value</strong>": a random nonce, generated locally in the mail client. The nonce is a random string of no less than 32 ASCII characters. The nonce may not repeat for at least 24 hours with the same service.</p>
</li>
<li><p>"<strong>algorithm</strong>": the signing algorithm, consistent with the Mail/HTTPS signing algorithms. </p>
</li>
<li><p>"<strong>signature</strong>": signature using user's private signing key of the concatenated values of host and nonce in that order, without any separators. Signature is in <em>detached</em> mode. </p>
</li>
<li><p>"<strong>key</strong>": the public signing key of the user, needed for verifying the signature. The public key MUST be simple Base64 encoded with padding.</p>
</li>
</ul>
<p>The advantage of the SOTN scheme is in the lack of passwords, and the use of signed nonces over HTTPS which provides robust protection against both man-in-the-middle and replay attacks.</p>
<p>Authentication undertakes the following steps:</p>
<ol>
<li>The service being authenticated checks that the provided nonce hasn't been used previously within the past 24 hours.</li>
<li>If the service being authenticated is own mail agent, the public key is compared with the same of the user identified.</li>
<li>Finally, the signature of the nonce using the provided public key.</li>
</ol>
<div class="mermaid" data-processed="true"><svg id="mermaid-1740093360286" width="100%" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" height="1222.012451171875" style="max-width: 443.8812255859375px;" viewBox="0 0 443.8812255859375 1222.012451171875"><style>#mermaid-1740093360286 {font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;fill:#333;}#mermaid-1740093360286 .error-icon{fill:#552222;}#mermaid-1740093360286 .error-text{fill:#552222;stroke:#552222;}#mermaid-1740093360286 .edge-thickness-normal{stroke-width:2px;}#mermaid-1740093360286 .edge-thickness-thick{stroke-width:3.5px;}#mermaid-1740093360286 .edge-pattern-solid{stroke-dasharray:0;}#mermaid-1740093360286 .edge-pattern-dashed{stroke-dasharray:3;}#mermaid-1740093360286 .edge-pattern-dotted{stroke-dasharray:2;}#mermaid-1740093360286 .marker{fill:#333333;stroke:#333333;}#mermaid-1740093360286 .marker.cross{stroke:#333333;}#mermaid-1740093360286 svg{font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:16px;}#mermaid-1740093360286 .label{font-family:"trebuchet ms",verdana,arial,sans-serif;color:#333;}#mermaid-1740093360286 .cluster-label text{fill:#333;}#mermaid-1740093360286 .cluster-label span{color:#333;}#mermaid-1740093360286 .label text,#mermaid-1740093360286 span{fill:#333;color:#333;}#mermaid-1740093360286 .node rect,#mermaid-1740093360286 .node circle,#mermaid-1740093360286 .node ellipse,#mermaid-1740093360286 .node polygon,#mermaid-1740093360286 .node path{fill:#ECECFF;stroke:#9370DB;stroke-width:1px;}#mermaid-1740093360286 .node .label{text-align:center;}#mermaid-1740093360286 .node.clickable{cursor:pointer;}#mermaid-1740093360286 .arrowheadPath{fill:#333333;}#mermaid-1740093360286 .edgePath .path{stroke:#333333;stroke-width:2.0px;}#mermaid-1740093360286 .flowchart-link{stroke:#333333;fill:none;}#mermaid-1740093360286 .edgeLabel{background-color:#e8e8e8;text-align:center;}#mermaid-1740093360286 .edgeLabel rect{opacity:0.5;background-color:#e8e8e8;fill:#e8e8e8;}#mermaid-1740093360286 .cluster rect{fill:#ffffde;stroke:#aaaa33;stroke-width:1px;}#mermaid-1740093360286 .cluster text{fill:#333;}#mermaid-1740093360286 .cluster span{color:#333;}#mermaid-1740093360286 div.mermaidTooltip{position:absolute;text-align:center;max-width:200px;padding:2px;font-family:"trebuchet ms",verdana,arial,sans-serif;font-size:12px;background:hsl(80, 100%, 96.2745098039%);border:1px solid #aaaa33;border-radius:2px;pointer-events:none;z-index:100;}#mermaid-1740093360286 :root{--mermaid-font-family:"trebuchet ms",verdana,arial,sans-serif;}</style><g><g class="output"><g class="clusters"></g><g class="edgePaths"><g class="edgePath LS-st LE-checkNonce" id="L-st-checkNonce" style="opacity: 1;"><path class="path" d="M160.07538604736328,53L160.07538604736328,57.166666666666664C160.07538604736328,61.333333333333336,160.07538604736328,69.66666666666667,160.15871938069662,78.08333384195963C160.24205271402994,86.50000101725259,160.40871938069662,95.00000203450516,160.49205271402994,99.25000254313146L160.57538604736328,103.50000305175774" marker-end="url(#arrowhead8962)" style="fill:none"></path><defs><marker id="arrowhead8962" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-checkNonce LE-reject" style="opacity: 1;" id="L-checkNonce-reject"><path class="path" d="M108.7963178825167,259.1990537833956L93.88495240209726,273.99556463557707C78.9735869216778,288.7920754877585,49.150855960838896,318.38509719212146,34.23949048041945,351.5136392943029C19.328125,384.6421813964844,19.328125,421.3062438964844,19.328125,457.9703063964844C19.328125,494.6343688964844,19.328125,531.2984313964844,19.328125,571.910540262858C19.328125,612.5226491292318,19.328125,657.0828043619791,19.328125,701.6429595947266C19.328125,746.203114827474,19.328125,790.7632700602213,19.328125,837.7257690429688C19.328125,884.6882680257162,19.328125,934.0531107584635,19.328125,983.4179534912109C19.328125,1032.7827962239583,19.328125,1082.1476389567058,37.55872344970703,1114.505639048706C55.78932189941406,1146.863639140706,92.25051879882812,1162.2147965919587,110.48111724853516,1169.890375317585L128.7117156982422,1177.5659540432114" marker-end="url(#arrowhead8963)" style="fill:none"></path><defs><marker id="arrowhead8963" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-checkNonce LE-isHomeAgent" style="opacity: 1;" id="L-checkNonce-isHomeAgent"><path class="path" d="M195.36167026112903,276.1918438379921L201.35633878368824,288.1562230144075C207.35100730624745,300.12060219082286,219.34034435136593,324.0493605436536,225.4183462072585,342.3470730534023C231.49634806315103,360.64478556315106,231.66301472981772,373.3114522298177,231.74634806315103,379.64478556315106L231.82968139648438,385.9781188964844" marker-end="url(#arrowhead8964)" style="fill:none"></path><defs><marker id="arrowhead8964" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-isHomeAgent LE-publicKeyMatchesLocal" style="opacity: 1;" id="L-isHomeAgent-publicKeyMatchesLocal"><path class="path" d="M203.76219498013504,502.89500748013506L196.77461509981958,513.7395885495266C189.7870352195041,524.5841696189182,175.81187545887315,546.2733317577013,168.907628911891,563.4512466690525C162.00338236490884,580.6291615804035,162.17004903157553,593.2958292643228,162.25338236490884,599.6291631062825L162.3367156982422,605.9624969482421" marker-end="url(#arrowhead8965)" style="fill:none"></path><defs><marker id="arrowhead8965" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-isHomeAgent LE-verifySignature" style="opacity: 1;" id="L-isHomeAgent-verifySignature"><path class="path" d="M261.97347331081187,500.8187019821569L269.915002783424,512.0093339678782C277.856532256036,523.1999659535994,293.7395912012602,545.5812299250418,301.6811206738723,579.0519395271368C309.6226501464844,612.5226491292318,309.6226501464844,657.0828043619791,309.6226501464844,701.6429595947266C309.6226501464844,746.203114827474,309.6226501464844,790.7632700602213,310.55353722952333,821.1398048521824C311.48442431256234,851.5163396441434,313.34619847864025,867.7092539953179,314.2770855616792,875.8057111709053L315.20797264471815,883.9021683464927" marker-end="url(#arrowhead8966)" style="fill:none"></path><defs><marker id="arrowhead8966" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-publicKeyMatchesLocal LE-verifySignature" style="opacity: 1;" id="L-publicKeyMatchesLocal-verifySignature"><path class="path" d="M217.4120891645938,743.2480609818905L238.00187016157557,758.5939550337367C258.59165115855734,773.9398490855832,299.77121315252083,804.6316371892759,319.59677383043396,828.0739874967608C339.4223345083471,851.5163378042456,337.89389387020975,867.7092503155224,337.1296735511411,875.8057065711608L336.3654532320724,883.9021628267992" marker-end="url(#arrowhead8967)" style="fill:none"></path><defs><marker id="arrowhead8967" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-publicKeyMatchesLocal LE-reject" style="opacity: 1;" id="L-publicKeyMatchesLocal-reject"><path class="path" d="M162.3367156982422,798.3234283447265L162.25338236490884,804.490094502767C162.17004903157553,810.6567606608072,162.00338236490884,822.9900929768879,161.92004903157553,853.839180501302C161.8367156982422,884.6882680257162,161.8367156982422,934.0531107584635,161.8367156982422,983.4179534912109C161.8367156982422,1032.7827962239583,161.8367156982422,1082.1476389567058,161.8367156982422,1113.0800603230794C161.8367156982422,1144.0124816894531,161.8367156982422,1156.5124816894531,161.8367156982422,1162.7624816894531L161.8367156982422,1169.0124816894531" marker-end="url(#arrowhead8968)" style="fill:none"></path><defs><marker id="arrowhead8968" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-verifySignature LE-success" style="opacity: 1;" id="L-verifySignature-success"><path class="path" d="M339.15544678958867,1081.1437567016226L340.23787130740465,1089.5385441995943C341.32029582522057,1097.933331697566,343.4851448608525,1114.7229066935097,344.5675693786684,1129.3676941914814C345.6499938964844,1144.0124816894531,345.6499938964844,1156.5124816894531,345.6499938964844,1162.7624816894531L345.6499938964844,1169.0124816894531" marker-end="url(#arrowhead8969)" style="fill:none"></path><defs><marker id="arrowhead8969" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g><g class="edgePath LS-verifySignature LE-reject" style="opacity: 1;" id="L-verifySignature-reject"><path class="path" d="M289.86066906784845,1058.5864411625748L283.8892937727676,1070.740781250388C277.9179184776867,1082.8951213382009,265.975167887525,1107.203801513827,250.15867565925728,1125.7652409104528C234.3421834309896,1144.326680307078,214.65194956461588,1157.1408789247032,204.80683263142905,1163.5479782335158L194.9617156982422,1169.9550775423281" marker-end="url(#arrowhead8970)" style="fill:none"></path><defs><marker id="arrowhead8970" viewBox="0 0 10 10" refX="9" refY="5" markerUnits="strokeWidth" markerWidth="8" markerHeight="6" orient="auto"><path d="M 0 0 L 10 5 L 0 10 z" class="arrowheadPath" style="stroke-width: 1; stroke-dasharray: 1, 0;"></path></marker></defs></g></g><g class="edgeLabels"><g class="edgeLabel" style="opacity: 1;" transform=""><g transform="translate(0,0)" class="label"><rect rx="0" ry="0" width="0" height="0"></rect><foreignObject width="0" height="0"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-st-checkNonce" class="edgeLabel L-LS-st' L-LE-checkNonce"></span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(19.328125,701.6429595947266)"><g transform="translate(-11.328125,-12.5)" class="label"><rect rx="0" ry="0" width="22.65625" height="25"></rect><foreignObject width="22.65625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-checkNonce-reject" class="edgeLabel L-LS-checkNonce' L-LE-reject">Yes</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(231.32968139648438,347.9781188964844)"><g transform="translate(-9.3984375,-12.5)" class="label"><rect rx="0" ry="0" width="18.796875" height="25"></rect><foreignObject width="18.796875" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-checkNonce-isHomeAgent" class="edgeLabel L-LS-checkNonce' L-LE-isHomeAgent">No</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(161.8367156982422,567.9624938964844)"><g transform="translate(-11.328125,-12.5)" class="label"><rect rx="0" ry="0" width="22.65625" height="25"></rect><foreignObject width="22.65625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-isHomeAgent-publicKeyMatchesLocal" class="edgeLabel L-LS-isHomeAgent' L-LE-publicKeyMatchesLocal">Yes</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(309.6226501464844,701.6429595947266)"><g transform="translate(-9.3984375,-12.5)" class="label"><rect rx="0" ry="0" width="18.796875" height="25"></rect><foreignObject width="18.796875" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-isHomeAgent-verifySignature" class="edgeLabel L-LS-isHomeAgent' L-LE-verifySignature">No</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(340.9507751464844,835.3234252929688)"><g transform="translate(-11.328125,-12.5)" class="label"><rect rx="0" ry="0" width="22.65625" height="25"></rect><foreignObject width="22.65625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-publicKeyMatchesLocal-verifySignature" class="edgeLabel L-LS-publicKeyMatchesLocal' L-LE-verifySignature">Yes</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(161.8367156982422,983.4179534912109)"><g transform="translate(-9.3984375,-12.5)" class="label"><rect rx="0" ry="0" width="18.796875" height="25"></rect><foreignObject width="18.796875" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-publicKeyMatchesLocal-reject" class="edgeLabel L-LS-publicKeyMatchesLocal' L-LE-reject">No</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(345.6499938964844,1131.5124816894531)"><g transform="translate(-11.328125,-12.5)" class="label"><rect rx="0" ry="0" width="22.65625" height="25"></rect><foreignObject width="22.65625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-verifySignature-success" class="edgeLabel L-LS-verifySignature' L-LE-success">Yes</span></div></foreignObject></g></g><g class="edgeLabel" style="opacity: 1;" transform="translate(254.03241729736328,1131.5124816894531)"><g transform="translate(-9.3984375,-12.5)" class="label"><rect rx="0" ry="0" width="18.796875" height="25"></rect><foreignObject width="18.796875" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;"><span id="L-L-verifySignature-reject" class="edgeLabel L-LS-verifySignature' L-LE-reject">No</span></div></foreignObject></g></g></g><g class="nodes"><g class="node default" id="flowchart-st-8848" transform="translate(160.07538604736328,30.5)" style="opacity: 1;"><rect rx="0" ry="0" x="-83.015625" y="-22.5" width="166.03125" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-73.015625,-12.5)"><foreignObject width="146.03125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Start Authentication</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-checkNonce-8849" transform="translate(160.07538604736328,206.7390594482422)"><polygon points="103.7390625,0 207.478125,-103.7390625 103.7390625,-207.478125 0,-103.7390625" transform="translate(-103.7390625,103.7390625)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-82.765625,-12.5)"><foreignObject width="165.53125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Previously Seen Nonce?</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-reject-8851" transform="translate(161.8367156982422,1191.5124816894531)"><rect rx="0" ry="0" x="-33.125" y="-22.5" width="66.25" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-23.125,-12.5)"><foreignObject width="46.25" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Reject</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-isHomeAgent-8853" transform="translate(231.32968139648438,457.9703063964844)"><polygon points="72.4921875,0 144.984375,-72.4921875 72.4921875,-144.984375 0,-72.4921875" transform="translate(-72.4921875,72.4921875)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-48.046875,-12.5)"><foreignObject width="96.09375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">User is Local?</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-publicKeyMatchesLocal-8855" transform="translate(161.8367156982422,701.6429595947266)"><polygon points="96.18046875,0 192.3609375,-96.18046875 96.18046875,-192.3609375 0,-96.18046875" transform="translate(-96.18046875,96.18046875)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-74.3671875,-12.5)"><foreignObject width="148.734375" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Matching Public Key?</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-verifySignature-8857" transform="translate(325.2867126464844,983.4179534912109)"><polygon points="110.59453125,0 221.1890625,-110.59453125 110.59453125,-221.1890625 0,-110.59453125" transform="translate(-110.59453125,110.59453125)" class="label-container"></polygon><g class="label" transform="translate(0,0)"><g transform="translate(-90.3828125,-12.5)"><foreignObject width="180.765625" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Correct Nonce Signature?</div></foreignObject></g></g></g><g class="node default" style="opacity: 1;" id="flowchart-success-8863" transform="translate(345.6499938964844,1191.5124816894531)"><rect rx="0" ry="0" x="-60.9765625" y="-22.5" width="121.953125" height="45" class="label-container"></rect><g class="label" transform="translate(0,0)"><g transform="translate(-50.9765625,-12.5)"><foreignObject width="101.953125" height="25"><div xmlns="http://www.w3.org/1999/xhtml" style="display: inline-block; white-space: nowrap;">Authenticated</div></foreignObject></g></g></g></g></g></g></svg></div>
<h3 class="atx" id="sotn-authorization-header-example">SOTN Authorization Header Example</h3>
<pre><code class="fenced-code-block">Authorization: SOTN
  nonce=7ypf/xlj9XXwfDPEoM4URrv/xwf94BcCAzFZH4GiTo0v;
  host=destination.host.tld;
  algorithm=ed25519;
  signature=pWHxd1/jCwkO5Ao5+sc+xDI01DWER2VAYBKCDEK/LgPBBw;
  key=ZjoCijxLNI2ts3NgQKNyxNR3E+gROmyEFsI8YUGJGZs</code></pre>
<h2 class="atx" id="public-api">Public API</h2>
<p>In Mail/HTTPS, mail agents serve a public API primarily for agent discovery as well storing of notifications and retrieval of messages. The location (hostname) of the mail agent is determined by the well-known scheme described previously in the mail agent discovery part of this document.</p>
<h3 class="atx" id="discovery-1">Discovery</h3>
<p>Determining if a mail agent is responsible for a particular domain or address is useful for selecting mail agents as well supporting provisioning new accounts.</p>
<h4 class="atx">Domain</h4>
<p>To determine existence of a <em>HOST_PART</em> of a given address <em>LOCAL_PART@HOST_PART</em> on a determined mail agent <em>MAIL_AGENT_HOSTNAME</em>, following requests can be made:</p>
<pre><code class="fenced-code-block">HTTPS HEAD https://MAIL_AGENT_HOSTNAME/mail/HOST_PART
HTTPS GET  https://MAIL_AGENT_HOSTNAME/mail/HOST_PART</code></pre>
<p>An <em>HTTP 200 OK</em> status response indicates presence of the address while <em>HTTP 404 Not Found</em> status its absence. The returned body content is informational only.</p>
<h4 class="atx" id="address">Address</h4>
<p>To determine existence of a given address <em>LOCAL_PART@HOST_PART</em> on a determined mail agent <em>MAIL_AGENT_HOSTNAME</em>, following requests can be made:</p>
<pre><code class="fenced-code-block">HTTPS HEAD https://MAIL_AGENT_HOSTNAME/mail/HOST_PART/LOCAL_PART
HTTPS GET https://MAIL_AGENT_HOSTNAME/mail/HOST_PART/LOCAL_PART</code></pre>
<p>An <em>HTTP 200 OK</em> status response indicates presence of the address while <em>HTTP 404</em> status its absence. The returned body content is informational only.</p>
<h3 class="atx" id="provisioning">Provisioning</h3>
<p>Mail agents can permit registering of new accounts publicly on their domains. If permitted, use of the following simple generic account provisioning API is recommended as it would permit direct, standardized provisioning from mail clients.</p>
<p>Abuse  prevention mechanisms are beyond the scope of this document, but mail 
agents can typically restrict or rate limit provisioning based on IP addresses for example.</p>
<h4 class="atx" id="create">Create</h4>
<p>To provision a new account on a selected mail agent, the mail client generates encryption and signing key pairs locally.</p>
<p>Using the generated keys, the signing key in particular, the mail client posts profile data of the account being provisioned of address <em>LOCAL_PART@HOST_PART</em> in a <strong>SOTN</strong> authenticated request.</p>
<pre><code class="fenced-code-block">HTTPS POST /account/HOST_PART/LOCAL_PART</code></pre>
<p>The <em>Signing-Key</em> profile attribute is required and must match the authentication public signing key as a proof of profile and private key ownership. While the <em>Signing-Key</em> is the only required profile attribute, mail clients will typically provide with a more complete profile information, including <em>Name</em>, <em>Encryption-Key</em> etc. </p>
<p>If an account with existing address exists already on the mail agent, an HTTP error status of <em>HTTP 409 Conflict</em> is expected. </p>
<p>A successful provisioning returns <em>HTTP 200 OK</em> status code. The returned body content is informational only. Account must be instantly available after a success response.</p>
<h4 class="atx" id="delete">Delete</h4>
<p>Mail agents may permit removal of a given account through a <strong>SOTN</strong> authenticated request.</p>
<pre><code class="fenced-code-block">HTTPS DELETE /account/HOST_PART/LOCAL_PART</code></pre>
<p>A successful deletion request returns <em>HTTP 200 OK</em> or <em>HTTP 202 Accepted</em> status codes. The returned body content is informational only.</p>
<h3 class="atx" id="profile">Profile</h3>
<p>The user's profile is served by the user's mail agents. No authentication is required. For a given address <em>LOCAL_PART@HOST_PART</em>, the profile is expected at the path below.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/profile</code></pre>
<p>The plaintext response body is expected only with a <em>HTTP 200 OK</em> status. If the user is not known by the mail agent, <em>HTTP 404 Not Found</em> status is expected.</p>
<h3 class="atx" id="profile-image">Profile Image</h3>
<p>The user's profile is served by the user's mail agents. No authentication is required. For a given address <em>LOCAL_PART@HOST_PART</em>, the profile is expected at the path below.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/image</code></pre>
<p>The plaintext response body is expected only with a <em>HTTP 200 OK</em> status. If the user is not known by the mail agent, <em>HTTP 404 Not Found</em> status is expected.</p>
<h3 class="atx" id="links-2">Links</h3>
<h4 class="atx" id="query">Query</h4>
<p>A remote user may openly query <em>LOCAL_PART@HOST_PART</em> user's mail agent for the existence of connection identifier LINK.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/link/LINK</code></pre>
<p>The contact querying does not require authentication. </p>
<p>The mail agent responds with either:</p>
<ul>
<li><p><em>HTTP 200 OK</em> status if the link exists</p>
</li>
<li><p><em>HTTP 404 Not Found</em> status if the link does not exist </p>
</li>
<li><p><em>HTTP 403 Forbidden</em> if the mail agent user does not consent to public lookups (<em>Public-Links</em> profile field)</p>
</li>
</ul>
<h3 class="atx" id="notifications-2">Notifications</h3>
<p>Once an author makes a message available to readers by uploading it to own mail agents, the author is expected to notify readers' mail agents of the presence of new messages.</p>
<p>The notifications calls require SOTN authentication. </p>
<p>The payload contains anonymously, asymmetrically encrypted email address of the notification sender using the reader's public encryption key.</p>
<p>Mail agent of the user being notified does not have enough data to verify the notification request and accepts the request even if unverified taken the SOTN authentication succeeds. The verification of the notification validity always happens locally on mail clients using actual profile data. </p>
<p>For a given reader's address of <em>LOCAL_PART@HOST_PART</em> and connection identifier <em>LINK</em> between notifier (author) and reader (notification recipient), the notification request 
is made at path bellow.</p>
<pre><code class="fenced-code-block">HTTPS PUT /mail/HOST_PART/LOCAL_PART/link/LINK/notifications</code></pre>
<p>Accepted notifications are confirmed with a <em>HTTP 200 OK</em> status response by the remote mail agent. Any returned body content is informational only.</p>
<p>If the reader does not accept public contact requests (profile field <em>Public-Access</em>) and the connection identifier (link) is not known to the reader, the home agent responds with a <em>HTTP 403 Forbidden</em> status. The same response is given for notifications directed to self by the user.</p>
<p>Repeated requests for the same link which exists among the reader's links, should 
extend the lifetime of the initial notification just as if the previous notification did not exist.</p>
<p>Repeated requests for non-existing links (contact requests) should however not extend the lifetime of the initial notification.</p>
<p>All notifications past their lifetime are silently dropped on the mail agent.</p>
<h4 class="atx" id="abuse-prevention">Abuse Prevention</h4>
<p>To prevent flooding of contact requests, mail agents may implement protections such as:</p>
<ul>
<li><p>limiting new contact requests for a period of time, e.g. 5 minutes</p>
</li>
<li><p>limiting contact requests from a given IP to one</p>
</li>
<li><p>allow only one contact request per given time period.</p>
</li>
</ul>
<h3 class="atx" id="messages">Messages</h3>
<p>Mail/HTTPS messages API is stateless. The responsibility of keeping state and not re-downloading already retrieved messages is shifted completely to mail clients.</p>
<h4 class="atx" id="private-messages">Private Messages</h4>
<p>After the reader acts upon the notification, its client is expected to connect to the author's mail agent to list and retrieve private messages. All requests to private messages API must be SOTN authenticated.</p>
<h5 class="atx" id="list">List</h5>
<p>For a given author's address of <em>LOCAL_PART@HOST_PART</em>, and connection identifier <em>LINK</em> between author and reader, the reader may request a list of available messages at the path below.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/link/LINK/messages</code></pre>
<p>If the reader is observing a particular stream of the author identified by stream name STREAM, the available messages are listed at the path below.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/link/LINK/streams/STREAM/messages</code></pre>
<p>Common HTTP status responses apply. The plaintext response body is expected only with a <em>HTTP 200 OK</em> status, as a list of message identifiers, each identifier on its own line.</p>
<h5 class="atx" id="retrieve">Retrieve</h5>
<p>Once the list of identifiers of private messages from author <em>LOCAL_PART@HOST_PART</em> 
available for a specific connection identifier <em>LINK</em> is obtained, each of the message identifiers <em>MESSAGE_ID</em> can be used for retrieving the relevant message from a path below.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/link/LINK/messages/MESSAGE_ID</code></pre>
<p>Successful <em>HTTP 200 OK</em> status response contains reserved Mail/HTTPS headers and the response body contains the message payload.</p>
<p>If the message is unknown, <em>HTTP 404 Not found</em> response is returned.</p>
<h4 class="atx" id="broadcast-messages">Broadcast Messages</h4>
<p>Broadcast messages are messages without specific readers. As such they are not encrypted but only signed.</p>
<p>While author could send out notifications to all contacts, broadcast messages are retrieved by readers through periodic polling. </p>
<p>Unlike private messages, requests for listing and retrieving broadcast messages does not require authentication.</p>
<h5 class="atx" id="list-1">List</h5>
<p>For a given author's address of <em>LOCAL_PART@HOST_PART</em>, the reader may request a list of available broadcast messages at the path below.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/messages</code></pre>
<p>If the reader is observing a particular stream of the author identified by stream name <em>STREAM</em>, the available messages are listed at the path below.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/streams/STREAM/messages</code></pre>
<p>The plaintext response body is expected only with a <em>HTTP 200 OK</em> status, as a list of message identifiers, each identifier on its own line. </p>
<p>The mail agents are stateless and do not keep state of messages already 
retrieved. It is important that mail clients preserve state of already retrieved messages so that repeated retrieval of messages of same user does not result in duplicated messages.  </p>
<h5 class="atx" id="retrieve-1">Retrieve</h5>
<p>For a given author's address of <em>LOCAL_PART@HOST_PART</em>, and previously obtained message identifier <em>MESSAGE_ID</em>, the reader may retrieve the relevant broadcast messages at the path below.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/messages/MESSAGE_ID</code></pre>
<p>Successful <em>HTTP 200 OK</em> status response contain reserved Mail/HTTPS headers and the response body contains the message payload.</p>
<p>If the message is unknown, <em>HTTP 404 Not found</em> response is returned.</p>
<h2 class="atx" id="private-api">Private API</h2>
<p>While the public mail agent API defines interoperability between clients and mail agents of contacts, the private API defines a universal mail  clients communication with home mail agents.All private mail API requests are under the path *"/home"* and must be authenticated. In the following examples, it is assumed that the user's address is <em>LOCAL_PART@HOST_PART</em>.</p>
<h3 class="atx" id="authenticated-discovery">Authenticated Discovery</h3>
<p>A common requirement in mail clients is to try authentication without any operations, as means of checking if authentication setup is correct.</p>
<pre><code class="fenced-code-block">HTTPS HEAD /home/HOST_PART/LOCAL_PART</code></pre>
<p><em>HTTP 200 OK</em> status response represents successful authentication. In case of multiple mail agents are delegated to, at least one must authenticate in order for authentication to be considered successful in mail clients. Failing mail agents should be reported to the user by mail clients.</p>
<h3 class="atx" id="notifications-3">Notifications</h3>
<h4 class="atx" id="list-2">List</h4>
<p>The private notifications API lists received third party notifications.</p>
<pre><code class="fenced-code-block">HTTPS GET /home/HOST_PART/LOCAL_PART/notifications</code></pre>
<p>In the response, each notification is listed on its own line as comma separated values</p>
<ul>
<li><p>unique notification identifier, assigned automatically by the mail agent</p>
</li>
<li><p>the connection link the notification was received for</p>
</li>
<li><p>author's public signing key, used for delivering the notification.</p>
</li>
<li><p>the payload sent by authors, containing encrypted author address</p>
</li>
</ul>
<p>Email clients must:</p>
<ul>
<li><p>Verify retrieved notifications before considering them authentic</p>
</li>
<li><p>Cache notifications locally to ensure same notifications are not repeatedly acted upon</p>
</li>
</ul>
<h3 class="atx" id="messages-1">Messages</h3>
<h4 class="atx" id="list-3">List</h4>
<p>Unlike the public counterpart, the messages list API call lists own, authored messages, awaiting pickup on the mail agent.</p>
<pre><code class="fenced-code-block">HTTPS GET /home/HOST_PART/LOCAL_PART/messages</code></pre>
<p>The response is a simple list of message identifiers (<em>MESSAGE_ID</em>), separated by a new line.</p>
<h4 class="atx" id="retrieve-2">Retrieve</h4>
<p>Each of the message identifiers <em>MESSAGE_ID</em> can be used for retrieving the relevant message from a path below.</p>
<pre><code class="fenced-code-block">HTTPS GET /mail/HOST_PART/LOCAL_PART/link/LINK/messages/MESSAGE_ID</code></pre>
<p>Successful <em>HTTP 200 OK</em> status response contains reserved Mail/HTTPS headers and the response body contains the message payload.</p>
<p>If the message is unknown, <em>HTTP 404 Not found</em> response is returned.</p>
<h4 class="atx" id="status">Status</h4>
<p>Mail agents maintain the delivery status of messages. The list call returns only active messages, while the status call should include both active messages and recent reader pickups.</p>
<p>Mail agents are recommended to retain delivery history for 14 to 30 days. Keeping records beyond this period is unnecessary due to potential key rotations.</p>
<pre><code class="fenced-code-block">HTTPS GET /home/HOST_PART/LOCAL_PART/messages/MESSAGE_ID/deliveries</code></pre>
<p>The response consists of a list where each entry is on a new line. Each entry contains two values separated by a comma: a link and the timestamp of its first access</p>
<h4 class="atx" id="upload">Upload</h4>
<p>Uploading call makes the authored message available to readers.</p>
<pre><code class="fenced-code-block">HTTPS POST /home/HOST_PART/LOCAL_PART/messages</code></pre>
<p>If the message identifier being uploaded already exists on the mail agent, the call is rejected early with status <em>HTTP 409 Conflict</em>. </p>
<p>Updates to already uploaded messages are not permitted, but messages may be revoked by deleting them using the delete request.</p>
<h4 class="atx" id="delete-1">Delete</h4>
<p>The delete request removes the message with id <em>MESSAGE_ID</em> from the mail agent and makes it unavailable from reading by readers, even if they have been previously notified by a notification.</p>
<pre><code class="fenced-code-block">HTTPS DELETE /home/HOST_PART/LOCAL_PART/messages/MESSAGE_ID</code></pre>
<p>Response status <em>HTTP 200 OK</em> indicates the message has been permanently removed from the mail agent.</p>
<h3 class="atx" id="profile-1">Profile</h3>
<p>User profile is stored and served as a simple textual file on the mail agent. </p>
<p>Management of profile contents is left entirely to mail clients. The mail agent should however refuse to update a profile with invalid, incomplete or oversized content.</p>
<h4 class="atx" id="update">Update</h4>
<pre><code class="fenced-code-block">HTTPS PUT /home/HOST_PART/LOCAL_PART/profile</code></pre>
<h3 class="atx" id="profile-image-1">Profile Image</h3>
<h4 class="atx" id="update-1">Update</h4>
<p>User profile image is stored and served as an image file on the mail agent, without any image conversions. The mail agent should refuse to update a profile image with invalid or oversized content.</p>
<pre><code class="fenced-code-block">HTTPS PUT /home/HOST_PART/LOCAL_PART/image</code></pre>
<h4 class="atx" id="delete-2">Delete</h4>
<p>The profile image may be removed, in which case a placeholder can be served by email clients directly.</p>
<pre><code class="fenced-code-block">HTTPS DELETE /home/HOST_PART/LOCAL_PART/image</code></pre>
<h3 class="atx" id="links-3">Links</h3>
<p>Links or connection identifiers are stored on mail agents:</p>
<ul>
<li><p>to synchronize contacts among connecting clients</p>
</li>
<li><p>to enforce notification restrictions </p>
</li>
<li><p>to support contact discovery</p>
</li>
</ul>
<h4 class="atx" id="list-4">List</h4>
<p>The list call retrieves all user's connection identifiers, which implies all user contacts.</p>
<pre><code class="fenced-code-block">HTTPS GET /home/HOST_PART/LOCAL_PART/links</code></pre>
<p>The response consists of a list where each entry is on a new line. Each entry contains two values separated by a comma: a link and the encrypted email address of the  contact.</p>
<h4 class="atx" id="store">Store</h4>
<p>The store call saves the connection identifier link (<em>LINK</em>) on the mail agent of the authenticating user. The request body contains encrypted email address of the respective link contact.</p>
<p>The assumed encryption method is anonymous asymmetric encryption. However, users can configure a different method in their email clients, provided that all of their clients use the same encryption scheme.</p>
<pre><code class="fenced-code-block">HTTPS PUT /home/HOST_PART/LOCAL_PART/links/LINK</code></pre>
<p>Response status <em>HTTP 200 OK</em> indicates the link was successfully stored on the mail agent.</p>
<h4 class="atx" id="delete-3">Delete</h4>
<p>The delete call removes the given connection identifier <em>LINK</em> of the authenticating user.</p>
<pre><code class="fenced-code-block">HTTPS DELETE /home/HOST_PART/LOCAL_PART/links/LINK</code></pre>
<p>Response status <em>HTTP 200 OK</em> indicates the link has been permanently removed from the mail agent.</p>
</article>
</body>
</html>